import{_ as a,c as e,o as i,a0 as t}from"./chunks/framework.CHkYM5Ax.js";const k=JSON.parse('{"title":"Docker 支持使用指南","description":"","frontmatter":{},"headers":[],"relativePath":"project/setup/DOCKER_GUIDE.md","filePath":"project/setup/DOCKER_GUIDE.md","lastUpdated":1766808668000}'),n={name:"project/setup/DOCKER_GUIDE.md"};function l(p,s,o,h,d,r){return i(),e("div",null,[...s[0]||(s[0]=[t(`<h1 id="docker-支持使用指南" tabindex="-1">Docker 支持使用指南 <a class="header-anchor" href="#docker-支持使用指南" aria-label="Permalink to &quot;Docker 支持使用指南&quot;">​</a></h1><p>已为项目添加了完整的 Docker 支持。现在你可以使用 Docker Compose 一键启动包含 PostgreSQL 数据库的完整开发环境。</p><h2 id="已添加的文件" tabindex="-1">已添加的文件 <a class="header-anchor" href="#已添加的文件" aria-label="Permalink to &quot;已添加的文件&quot;">​</a></h2><ul><li>[Dockerfile](file:///Users/mayunlong/自己的/code/小玩意/nestbase/apps/backend/Dockerfile): 后端应用的构建定义</li><li>[docker-compose.yml](file:///Users/mayunlong/自己的/code/小玩意/nestbase/docker-compose.yml): 服务编排配置</li><li>[.dockerignore](file:///Users/mayunlong/自己的/code/小玩意/nestbase/.dockerignore): 构建忽略配置</li></ul><h2 id="快速开始" tabindex="-1">快速开始 <a class="header-anchor" href="#快速开始" aria-label="Permalink to &quot;快速开始&quot;">​</a></h2><h3 id="_1-启动服务" tabindex="-1">1. 启动服务 <a class="header-anchor" href="#_1-启动服务" aria-label="Permalink to &quot;1. 启动服务&quot;">​</a></h3><p>在项目根目录下运行：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><p>这将启动两个容器：</p><ul><li><code>nestbase-db</code>: PostgreSQL 15 数据库 (端口 5432)</li><li><code>nestbase-app</code>: NestJS 后端服务 (端口 3000)</li></ul><h3 id="_2-初始化数据库" tabindex="-1">2. 初始化数据库 <a class="header-anchor" href="#_2-初始化数据库" aria-label="Permalink to &quot;2. 初始化数据库&quot;">​</a></h3><p>由于是全新的数据库容器，第一次启动后需要同步 Schema：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 确保你使用本地的 .env 配置指向 Docker 数据库，或者直接传入环境变量</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 默认 docker-compose 中的 app 服务已经配置好了连接 docker 内数据库的环境变量</span></span></code></pre></div><p>如果你需要在本机（宿主机）上操作 Docker 中的数据库（例如运行 Prisma migration）：</p><p>确保你的 <code>.env</code> 文件（或临时环境变量）指向本地端口 5432：</p><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DATABASE_URL=&quot;postgresql://postgres:postgres@localhost:5432/nestbase&quot;</span></span></code></pre></div><p>然后运行：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prisma</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prisma</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> migrate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre></div><h3 id="_3-查看日志" tabindex="-1">3. 查看日志 <a class="header-anchor" href="#_3-查看日志" aria-label="Permalink to &quot;3. 查看日志&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span></span></code></pre></div><h3 id="_4-停止服务" tabindex="-1">4. 停止服务 <a class="header-anchor" href="#_4-停止服务" aria-label="Permalink to &quot;4. 停止服务&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> down</span></span></code></pre></div><h2 id="验证结果" tabindex="-1">验证结果 <a class="header-anchor" href="#验证结果" aria-label="Permalink to &quot;验证结果&quot;">​</a></h2><p>✅ <code>docker compose config</code> 配置验证通过。</p><p><img src="https://img.shields.io/badge/Docker-Config%20Valid-brightgreen" alt="Docker Config Success"></p>`,25)])])}const g=a(n,[["render",l]]);export{k as __pageData,g as default};
