import{_ as i,c as a,o as n,a0 as h}from"./chunks/framework.CHkYM5Ax.js";const o=JSON.parse('{"title":"æƒé™ç³»ç»Ÿé‡æ„ - æ•°æ®åº“è¿ç§»æŒ‡å—","description":"","frontmatter":{},"headers":[],"relativePath":"backend/migrations/MIGRATION_GUIDE.md","filePath":"backend/migrations/MIGRATION_GUIDE.md","lastUpdated":1762852082000}'),l={name:"backend/migrations/MIGRATION_GUIDE.md"};function p(t,s,k,e,r,d){return n(),a("div",null,[...s[0]||(s[0]=[h(`<h1 id="æƒé™ç³»ç»Ÿé‡æ„-æ•°æ®åº“è¿ç§»æŒ‡å—" tabindex="-1">æƒé™ç³»ç»Ÿé‡æ„ - æ•°æ®åº“è¿ç§»æŒ‡å— <a class="header-anchor" href="#æƒé™ç³»ç»Ÿé‡æ„-æ•°æ®åº“è¿ç§»æŒ‡å—" aria-label="Permalink to &quot;æƒé™ç³»ç»Ÿé‡æ„ - æ•°æ®åº“è¿ç§»æŒ‡å—&quot;">â€‹</a></h1><h2 id="ğŸ“‹-è¿ç§»æ¦‚è¿°" tabindex="-1">ğŸ“‹ è¿ç§»æ¦‚è¿° <a class="header-anchor" href="#ğŸ“‹-è¿ç§»æ¦‚è¿°" aria-label="Permalink to &quot;ğŸ“‹ è¿ç§»æ¦‚è¿°&quot;">â€‹</a></h2><p>æœ¬æ¬¡é‡æ„ç®€åŒ–äº†æƒé™ç³»ç»Ÿï¼Œä¸»è¦å˜æ›´åŒ…æ‹¬ï¼š</p><h3 id="æ•°æ®åº“ç»“æ„å˜æ›´" tabindex="-1">æ•°æ®åº“ç»“æ„å˜æ›´ <a class="header-anchor" href="#æ•°æ®åº“ç»“æ„å˜æ›´" aria-label="Permalink to &quot;æ•°æ®åº“ç»“æ„å˜æ›´&quot;">â€‹</a></h3><h4 id="_1-permission-è¡¨ä¿®æ”¹" tabindex="-1">1. Permission è¡¨ä¿®æ”¹ <a class="header-anchor" href="#_1-permission-è¡¨ä¿®æ”¹" aria-label="Permalink to &quot;1. Permission è¡¨ä¿®æ”¹&quot;">â€‹</a></h4><p><strong>ç§»é™¤å­—æ®µ</strong>:</p><ul><li><code>resource</code> VARCHAR - èµ„æºåç§°</li><li><code>action</code> VARCHAR - æ“ä½œç±»å‹</li><li><code>is_system</code> BOOLEAN - æ˜¯å¦ç³»ç»Ÿå†…ç½®æƒé™</li><li><code>name</code> çš„ UNIQUE çº¦æŸï¼ˆname ä¸å†è¦æ±‚å”¯ä¸€ï¼‰</li></ul><p><strong>æ–°å¢å­—æ®µ</strong>:</p><ul><li><code>type</code> ENUM(&#39;MENU&#39;, &#39;BUTTON&#39;, &#39;API&#39;) - æƒé™ç±»å‹</li><li><code>menu_id</code> UUID NULL - å…³è”èœå•IDï¼ˆtypeä¸ºBUTTON/APIæ—¶ï¼‰</li></ul><h4 id="_2-menu-è¡¨ä¿®æ”¹" tabindex="-1">2. Menu è¡¨ä¿®æ”¹ <a class="header-anchor" href="#_2-menu-è¡¨ä¿®æ”¹" aria-label="Permalink to &quot;2. Menu è¡¨ä¿®æ”¹&quot;">â€‹</a></h4><p><strong>æ–°å¢å…³ç³»</strong>:</p><ul><li><code>permissions</code> - ä¸€å¯¹å¤šå…³ç³»ï¼ˆé€šè¿‡ Permission.menuIdï¼‰</li></ul><h4 id="_3-åˆ é™¤è¡¨" tabindex="-1">3. åˆ é™¤è¡¨ <a class="header-anchor" href="#_3-åˆ é™¤è¡¨" aria-label="Permalink to &quot;3. åˆ é™¤è¡¨&quot;">â€‹</a></h4><ul><li><strong>menu_permissions</strong> - èœå•æƒé™å…³è”è¡¨ï¼ˆå·²åºŸå¼ƒï¼‰</li></ul><hr><h2 id="ğŸš€-æ‰§è¡Œè¿ç§»æ­¥éª¤" tabindex="-1">ğŸš€ æ‰§è¡Œè¿ç§»æ­¥éª¤ <a class="header-anchor" href="#ğŸš€-æ‰§è¡Œè¿ç§»æ­¥éª¤" aria-label="Permalink to &quot;ğŸš€ æ‰§è¡Œè¿ç§»æ­¥éª¤&quot;">â€‹</a></h2><h3 id="æ–¹å¼ä¸€-ä½¿ç”¨-prisma-migrate-æ¨è" tabindex="-1">æ–¹å¼ä¸€ï¼šä½¿ç”¨ Prisma Migrateï¼ˆæ¨èï¼‰ <a class="header-anchor" href="#æ–¹å¼ä¸€-ä½¿ç”¨-prisma-migrate-æ¨è" aria-label="Permalink to &quot;æ–¹å¼ä¸€ï¼šä½¿ç”¨ Prisma Migrateï¼ˆæ¨èï¼‰&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. ç¡®ä¿åœ¨ apps/backend ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apps/backend</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. åˆ›å»ºè¿ç§»æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prisma</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> migrate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> refactor_permission_system</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿™ä¼šï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - ç”Ÿæˆè¿ç§» SQL æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - è‡ªåŠ¨åº”ç”¨åˆ°æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - é‡æ–°ç”Ÿæˆ Prisma Client</span></span></code></pre></div><h3 id="æ–¹å¼äºŒ-æ‰‹åŠ¨-sql-è¿ç§»" tabindex="-1">æ–¹å¼äºŒï¼šæ‰‹åŠ¨ SQL è¿ç§» <a class="header-anchor" href="#æ–¹å¼äºŒ-æ‰‹åŠ¨-sql-è¿ç§»" aria-label="Permalink to &quot;æ–¹å¼äºŒï¼šæ‰‹åŠ¨ SQL è¿ç§»&quot;">â€‹</a></h3><p>å¦‚æœæ‚¨å¸Œæœ›æ‰‹åŠ¨æ‰§è¡Œï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹ SQLï¼š</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 1. åˆ›å»ºæƒé™ç±»å‹æšä¸¾</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PermissionType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&quot; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ENUM (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;MENU&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;BUTTON&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;API&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 2. ä¿®æ”¹ permissions è¡¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- æ–°å¢å­—æ®µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;type&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;PermissionType&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;BUTTON&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;menu_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UUID,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- ç§»é™¤å­—æ®µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;resource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;is_system&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- ç§»é™¤ name å”¯ä¸€çº¦æŸ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions_name_key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 3. æ·»åŠ å¤–é”®çº¦æŸ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ADD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions_menu_id_fkey&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FOREIGN KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;menu_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  REFERENCES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;menus&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ON DELETE CASCADE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 4. åˆ é™¤ menu_permissions è¡¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;menu_permissions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CASCADE;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 5. åˆ›å»ºç´¢å¼•ï¼ˆå¯é€‰ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">permissions_type_idx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&quot; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">permissions_menu_id_idx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&quot; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;menu_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><hr><h2 id="âš ï¸-è¿ç§»å‰æ³¨æ„äº‹é¡¹" tabindex="-1">âš ï¸ è¿ç§»å‰æ³¨æ„äº‹é¡¹ <a class="header-anchor" href="#âš ï¸-è¿ç§»å‰æ³¨æ„äº‹é¡¹" aria-label="Permalink to &quot;âš ï¸ è¿ç§»å‰æ³¨æ„äº‹é¡¹&quot;">â€‹</a></h2><h3 id="_1-å¤‡ä»½æ•°æ®" tabindex="-1">1. å¤‡ä»½æ•°æ® <a class="header-anchor" href="#_1-å¤‡ä»½æ•°æ®" aria-label="Permalink to &quot;1. å¤‡ä»½æ•°æ®&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¤‡ä»½å½“å‰æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pg_dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your-host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your-user</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your-db</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup_before_migration.sql</span></span></code></pre></div><h3 id="_2-æ•°æ®è¿ç§»ç­–ç•¥" tabindex="-1">2. æ•°æ®è¿ç§»ç­–ç•¥ <a class="header-anchor" href="#_2-æ•°æ®è¿ç§»ç­–ç•¥" aria-label="Permalink to &quot;2. æ•°æ®è¿ç§»ç­–ç•¥&quot;">â€‹</a></h3><p>ç”±äºå­—æ®µç»“æ„å˜æ›´ï¼Œç°æœ‰æƒé™æ•°æ®éœ€è¦æ˜ å°„ï¼š</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ç¤ºä¾‹ï¼šå°†æ—§çš„ resource.action æ˜ å°„åˆ°æ–°çš„ type å’Œ code</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- è¿™éœ€è¦æ ¹æ®æ‚¨çš„å®é™…æ•°æ®è°ƒæ•´</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- å¯¹äºèœå•æƒé™ï¼ˆé€šå¸¸ action = &#39;view&#39; æˆ– &#39;access&#39;ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;type&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;MENU&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;action&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;view&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;access&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;read&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- å¯¹äºæŒ‰é’®æƒé™ï¼ˆcreate, update, deleteç­‰ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;type&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;BUTTON&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;action&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;create&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;update&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;delete&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;export&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;import&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- å¯¹äºAPIæƒé™</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;type&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;API&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;code&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;%:api:%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h3 id="_3-æ¸…ç†-menu-permissions-æ•°æ®" tabindex="-1">3. æ¸…ç† menu_permissions æ•°æ® <a class="header-anchor" href="#_3-æ¸…ç†-menu-permissions-æ•°æ®" aria-label="Permalink to &quot;3. æ¸…ç† menu_permissions æ•°æ®&quot;">â€‹</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ç”±äºæ–°ç³»ç»Ÿä¸å†ä½¿ç”¨ menu_permissions è¡¨</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- æƒé™ç›´æ¥é€šè¿‡ menuId å­—æ®µå…³è”èœå•</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- å¦‚æœéœ€è¦ä¿ç•™å…³è”å…³ç³»ï¼Œéœ€è¦æ‰‹åŠ¨è¿ç§»ï¼š</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;menu_id&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mp.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;menu_id&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;menu_permissions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mp</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mp.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;permission_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><hr><h2 id="âœ…-è¿ç§»åéªŒè¯" tabindex="-1">âœ… è¿ç§»åéªŒè¯ <a class="header-anchor" href="#âœ…-è¿ç§»åéªŒè¯" aria-label="Permalink to &quot;âœ… è¿ç§»åéªŒè¯&quot;">â€‹</a></h2><h3 id="_1-æ£€æŸ¥è¡¨ç»“æ„" tabindex="-1">1. æ£€æŸ¥è¡¨ç»“æ„ <a class="header-anchor" href="#_1-æ£€æŸ¥è¡¨ç»“æ„" aria-label="Permalink to &quot;1. æ£€æŸ¥è¡¨ç»“æ„&quot;">â€‹</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- æŸ¥çœ‹ permissions è¡¨ç»“æ„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\d permissions</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- ç¡®è®¤å­—æ®µï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- - type (PermissionType)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- - menu_id (UUID, nullable)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- - æ—  resource, action, is_system å­—æ®µ</span></span></code></pre></div><h3 id="_2-éªŒè¯æ•°æ®" tabindex="-1">2. éªŒè¯æ•°æ® <a class="header-anchor" href="#_2-éªŒè¯æ•°æ®" aria-label="Permalink to &quot;2. éªŒè¯æ•°æ®&quot;">â€‹</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- æŸ¥çœ‹æƒé™ç±»å‹åˆ†å¸ƒ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permissions</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GROUP BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- æŸ¥çœ‹å…³è”èœå•çš„æƒé™</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">menu_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permissions p</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LEFT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> menus m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">menu_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">menu_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IS NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h3 id="_3-æµ‹è¯•åº”ç”¨" tabindex="-1">3. æµ‹è¯•åº”ç”¨ <a class="header-anchor" href="#_3-æµ‹è¯•åº”ç”¨" aria-label="Permalink to &quot;3. æµ‹è¯•åº”ç”¨&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é‡æ–°ç”Ÿæˆ Prisma Client</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prisma</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generate</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿è¡Œç±»å‹æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tsc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --noEmit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯åŠ¨åº”ç”¨æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre></div><hr><h2 id="ğŸ”„-å›æ»šæ–¹æ¡ˆ" tabindex="-1">ğŸ”„ å›æ»šæ–¹æ¡ˆ <a class="header-anchor" href="#ğŸ”„-å›æ»šæ–¹æ¡ˆ" aria-label="Permalink to &quot;ğŸ”„ å›æ»šæ–¹æ¡ˆ&quot;">â€‹</a></h2><p>å¦‚æœéœ€è¦å›æ»šåˆ°æ—§ç‰ˆæœ¬ï¼š</p><h3 id="_1-ä½¿ç”¨-prisma-migrate-å›æ»š" tabindex="-1">1. ä½¿ç”¨ Prisma Migrate å›æ»š <a class="header-anchor" href="#_1-ä½¿ç”¨-prisma-migrate-å›æ»š" aria-label="Permalink to &quot;1. ä½¿ç”¨ Prisma Migrate å›æ»š&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æŸ¥çœ‹è¿ç§»å†å²</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prisma</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> migrate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prisma</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> migrate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reset</span></span></code></pre></div><h3 id="_2-æ‰‹åŠ¨å›æ»š-sql" tabindex="-1">2. æ‰‹åŠ¨å›æ»š SQL <a class="header-anchor" href="#_2-æ‰‹åŠ¨å›æ»š-sql" aria-label="Permalink to &quot;2. æ‰‹åŠ¨å›æ»š SQL&quot;">â€‹</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 1. é‡æ–°åˆ›å»º menu_permissions è¡¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">menu_permissions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&quot; (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UUID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uuid_generate_v4(),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;menu_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UUID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;permission_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UUID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;created_at&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TIMESTAMP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CURRENT_TIMESTAMP,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  CONSTRAINT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;menu_permissions_pkey&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  CONSTRAINT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;menu_permissions_menu_id_fkey&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOREIGN KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;menu_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">REFERENCES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;menus&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON DELETE CASCADE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  CONSTRAINT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;menu_permissions_permission_id_fkey&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOREIGN KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;permission_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">REFERENCES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON DELETE CASCADE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 2. æ¢å¤ permissions è¡¨å­—æ®µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;resource&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TEXT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;unknown&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;action&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TEXT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;manage&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;is_system&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> BOOLEAN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> false,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;menu_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ADD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CONSTRAINT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;permissions_name_key&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNIQUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 3. åˆ é™¤æšä¸¾ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;PermissionType&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><hr><h2 id="ğŸ“Š-æ–°æ—§å¯¹æ¯”" tabindex="-1">ğŸ“Š æ–°æ—§å¯¹æ¯” <a class="header-anchor" href="#ğŸ“Š-æ–°æ—§å¯¹æ¯”" aria-label="Permalink to &quot;ğŸ“Š æ–°æ—§å¯¹æ¯”&quot;">â€‹</a></h2><h3 id="æ—§ç³»ç»Ÿ" tabindex="-1">æ—§ç³»ç»Ÿ <a class="header-anchor" href="#æ—§ç³»ç»Ÿ" aria-label="Permalink to &quot;æ—§ç³»ç»Ÿ&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Permission {</span></span>
<span class="line"><span>  code: &quot;user.create&quot;</span></span>
<span class="line"><span>  name: &quot;åˆ›å»ºç”¨æˆ·&quot;</span></span>
<span class="line"><span>  resource: &quot;user&quot;</span></span>
<span class="line"><span>  action: &quot;create&quot;</span></span>
<span class="line"><span>  isSystem: false</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MenuPermission {</span></span>
<span class="line"><span>  menuId: &quot;menu-uuid&quot;</span></span>
<span class="line"><span>  permissionId: &quot;perm-uuid&quot;</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="æ–°ç³»ç»Ÿ" tabindex="-1">æ–°ç³»ç»Ÿ <a class="header-anchor" href="#æ–°ç³»ç»Ÿ" aria-label="Permalink to &quot;æ–°ç³»ç»Ÿ&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Permission {</span></span>
<span class="line"><span>  code: &quot;user:create&quot;</span></span>
<span class="line"><span>  name: &quot;åˆ›å»ºç”¨æˆ·&quot;</span></span>
<span class="line"><span>  type: &quot;BUTTON&quot;</span></span>
<span class="line"><span>  menuId: &quot;menu-uuid&quot;  // ç›´æ¥å…³è”</span></span>
<span class="line"><span>}</span></span></code></pre></div><hr><h2 id="ğŸ†˜-å¸¸è§é—®é¢˜" tabindex="-1">ğŸ†˜ å¸¸è§é—®é¢˜ <a class="header-anchor" href="#ğŸ†˜-å¸¸è§é—®é¢˜" aria-label="Permalink to &quot;ğŸ†˜ å¸¸è§é—®é¢˜&quot;">â€‹</a></h2><h3 id="q1-è¿ç§»å¤±è´¥æ€ä¹ˆåŠ" tabindex="-1">Q1: è¿ç§»å¤±è´¥æ€ä¹ˆåŠï¼Ÿ <a class="header-anchor" href="#q1-è¿ç§»å¤±è´¥æ€ä¹ˆåŠ" aria-label="Permalink to &quot;Q1: è¿ç§»å¤±è´¥æ€ä¹ˆåŠï¼Ÿ&quot;">â€‹</a></h3><p><strong>A</strong>:</p><ol><li>æ£€æŸ¥æ•°æ®åº“è¿æ¥</li><li>ç¡®è®¤æ²¡æœ‰å…¶ä»–è¿›ç¨‹å ç”¨æ•°æ®åº“</li><li>æŸ¥çœ‹ Prisma é”™è¯¯æ—¥å¿—</li><li>å¦‚æœ‰å¿…è¦ï¼Œä½¿ç”¨å¤‡ä»½æ¢å¤æ•°æ®</li></ol><h3 id="q2-ç°æœ‰æƒé™æ•°æ®å¦‚ä½•å¤„ç†" tabindex="-1">Q2: ç°æœ‰æƒé™æ•°æ®å¦‚ä½•å¤„ç†ï¼Ÿ <a class="header-anchor" href="#q2-ç°æœ‰æƒé™æ•°æ®å¦‚ä½•å¤„ç†" aria-label="Permalink to &quot;Q2: ç°æœ‰æƒé™æ•°æ®å¦‚ä½•å¤„ç†ï¼Ÿ&quot;">â€‹</a></h3><p><strong>A</strong>: éœ€è¦æ‰‹åŠ¨æ˜ å°„ã€‚å»ºè®®ï¼š</p><ol><li>å¯¼å‡ºç°æœ‰æƒé™æ•°æ®</li><li>ç¼–å†™è¿ç§»è„šæœ¬è½¬æ¢æ•°æ®</li><li>æ¸…ç©ºæ—§æ•°æ®</li><li>å¯¼å…¥æ–°æ ¼å¼æ•°æ®</li></ol><h3 id="q3-å¦‚ä½•ç¡®ä¿æ•°æ®ä¸€è‡´æ€§" tabindex="-1">Q3: å¦‚ä½•ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼Ÿ <a class="header-anchor" href="#q3-å¦‚ä½•ç¡®ä¿æ•°æ®ä¸€è‡´æ€§" aria-label="Permalink to &quot;Q3: å¦‚ä½•ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼Ÿ&quot;">â€‹</a></h3><p><strong>A</strong>:</p><ol><li>è¿ç§»å‰å¤‡ä»½</li><li>åœ¨æµ‹è¯•ç¯å¢ƒå…ˆæ‰§è¡Œ</li><li>éªŒè¯æ•°æ®å®Œæ•´æ€§</li><li>æµ‹è¯•åº”ç”¨åŠŸèƒ½</li><li>ç¡®è®¤æ— è¯¯åå†åœ¨ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œ</li></ol><hr><p><strong>åˆ›å»ºæ—¥æœŸ</strong>: 2025-10-27 <strong>Prisma ç‰ˆæœ¬</strong>: 5.22.0 <strong>æ•°æ®åº“</strong>: PostgreSQL (Supabase)</p>`,64)])])}const g=i(l,[["render",p]]);export{o as __pageData,g as default};
