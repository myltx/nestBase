<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ç”¨æˆ·è§’è‰²ç®¡ç†ç»Ÿä¸€åŒ–é‡æ„æ–‡æ¡£ | NestBase</title>
    <meta name="description" content="ç°ä»£åŒ–å…¨æ ˆåº”ç”¨æ¡†æ¶æ–‡æ¡£">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/nestBase/assets/style.f9zfzs4B.css" as="style">
    <link rel="preload stylesheet" href="/nestBase/vp-icons.css" as="style">
    
    <script type="module" src="/nestBase/assets/app.DbT4jWY3.js"></script>
    <link rel="preload" href="/nestBase/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/nestBase/assets/chunks/framework.CHkYM5Ax.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/theme.BK8qkPJq.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/katex.Cu_Erd72.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/dagre-6UL2VRFP.1nqorA0S.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/cose-bilkent-S5V4N54A.BG8u3-D8.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/c4Diagram-YG6GDRKO.BX9mxR8M.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/flowDiagram-NV44I4VS.C4kEXsYh.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/erDiagram-Q2GNP2WA.BkiZSfEW.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/gitGraphDiagram-NY62KEGX.CcFks8J9.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/ganttDiagram-JELNMOA3.BhLIvO8O.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/infoDiagram-WHAUD3N6.DzwrnBW_.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/pieDiagram-ADFJNKIX.INtIvMIs.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/quadrantDiagram-AYHSOK5B.BcwzgfdN.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/xychartDiagram-PRI3JC2R.DIJ1Rm6b.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/requirementDiagram-UZGBJVZJ.Bs9h98sG.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/sequenceDiagram-WL72ISMW.BQXcTMVI.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/classDiagram-2ON5EDUG.C4F3g3ed.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/classDiagram-v2-WZHVMYZB.C4F3g3ed.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/stateDiagram-FKZM4ZOC.CUeMBEXd.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/stateDiagram-v2-4FDKWEC3.D3JYjUjk.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/journeyDiagram-XKPGCS4Q.Bnwlss2g.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/timeline-definition-IT6M3QCI.C0CxPIiT.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/mindmap-definition-VGOIOE7T.BvNhA5i_.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/kanban-definition-3W4ZIXB7.C9cZJQ2o.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/sankeyDiagram-TZEHDZUN.5CoCZ6So.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/diagram-S2PKOQOG.BZOe_jrm.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/diagram-QEK2KX5R.B2ZYdQgA.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/blockDiagram-VD42YOAC.DPWirL71.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/architectureDiagram-VXUJARFQ.CrFTLouW.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/diagram-PSM6KHXK.OzIp6get.js">
    <link rel="modulepreload" href="/nestBase/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/nestBase/assets/backend_features_REFACTOR_USER_ROLES_INTEGRATION.md.D1dMMRJp.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-c5b340f5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-1adf3ada></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-1adf3ada>Skip to content</a><!--]--><!----><header class="VPNav" data-v-c5b340f5 data-v-4f77e6a2><div class="VPNavBar" data-v-4f77e6a2 data-v-23502b90><div class="wrapper" data-v-23502b90><div class="container" data-v-23502b90><div class="title" data-v-23502b90><div class="VPNavBarTitle has-sidebar" data-v-23502b90 data-v-19f43f6c><a class="title" href="/nestBase/" data-v-19f43f6c><!--[--><!--]--><!----><span data-v-19f43f6c>NestBase</span><!--[--><!--]--></a></div></div><div class="content" data-v-23502b90><div class="content-body" data-v-23502b90><!--[--><!--]--><div class="VPNavBarSearch search" data-v-23502b90><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-23502b90 data-v-70f47ae1><span id="main-nav-aria-label" class="visually-hidden" data-v-70f47ae1> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/nestBase/guides/USAGE.zh-CN.html" tabindex="0" data-v-70f47ae1 data-v-25406061><!--[--><span data-v-25406061>æŒ‡å—</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/nestBase/frontend/README.html" tabindex="0" data-v-70f47ae1 data-v-25406061><!--[--><span data-v-25406061>å‰ç«¯</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/nestBase/backend/README.html" tabindex="0" data-v-70f47ae1 data-v-25406061><!--[--><span data-v-25406061>åç«¯</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/nestBase/project/README.html" tabindex="0" data-v-70f47ae1 data-v-25406061><!--[--><span data-v-25406061>é¡¹ç›®ç®¡ç†</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-23502b90 data-v-7a219dbc><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-7a219dbc data-v-857579d8 data-v-5e249171><span class="check" data-v-5e249171><span class="icon" data-v-5e249171><!--[--><span class="vpi-sun sun" data-v-857579d8></span><span class="vpi-moon moon" data-v-857579d8></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-23502b90 data-v-8954fdda data-v-79b1515e><!--[--><a class="VPSocialLink no-icon" href="https://github.com/myltx/nestBase" aria-label="github" target="_blank" rel="noopener" data-v-79b1515e data-v-3130917f><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-23502b90 data-v-c519e90f data-v-b813f9c2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b813f9c2><span class="vpi-more-horizontal icon" data-v-b813f9c2></span></button><div class="menu" data-v-b813f9c2><div class="VPMenu" data-v-b813f9c2 data-v-1bf12b08><!----><!--[--><!--[--><!----><div class="group" data-v-c519e90f><div class="item appearance" data-v-c519e90f><p class="label" data-v-c519e90f>Appearance</p><div class="appearance-action" data-v-c519e90f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-c519e90f data-v-857579d8 data-v-5e249171><span class="check" data-v-5e249171><span class="icon" data-v-5e249171><!--[--><span class="vpi-sun sun" data-v-857579d8></span><span class="vpi-moon moon" data-v-857579d8></span><!--]--></span></span></button></div></div></div><div class="group" data-v-c519e90f><div class="item social-links" data-v-c519e90f><div class="VPSocialLinks social-links-list" data-v-c519e90f data-v-79b1515e><!--[--><a class="VPSocialLink no-icon" href="https://github.com/myltx/nestBase" aria-label="github" target="_blank" rel="noopener" data-v-79b1515e data-v-3130917f><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-23502b90 data-v-5702a5f9><span class="container" data-v-5702a5f9><span class="top" data-v-5702a5f9></span><span class="middle" data-v-5702a5f9></span><span class="bottom" data-v-5702a5f9></span></span></button></div></div></div></div><div class="divider" data-v-23502b90><div class="divider-line" data-v-23502b90></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-c5b340f5 data-v-75ae96a4><div class="container" data-v-75ae96a4><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-75ae96a4><span class="vpi-align-left menu-icon" data-v-75ae96a4></span><span class="menu-text" data-v-75ae96a4>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-75ae96a4 data-v-954fa734><button data-v-954fa734>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-c5b340f5 data-v-a8e137bb><div class="curtain" data-v-a8e137bb></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-a8e137bb><span class="visually-hidden" id="sidebar-aria-label" data-v-a8e137bb> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-337849fc><section class="VPSidebarItem level-0" data-v-337849fc data-v-145eeefe><div class="item" role="button" tabindex="0" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><h2 class="text" data-v-145eeefe>åç«¯æ¦‚è§ˆ</h2><!----></div><div class="items" data-v-145eeefe><!--[--><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/README.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>Readme</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-337849fc><section class="VPSidebarItem level-0 collapsible collapsed" data-v-337849fc data-v-145eeefe><div class="item" role="button" tabindex="0" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><h2 class="text" data-v-145eeefe>æ¶æ„è®¾è®¡</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-145eeefe><span class="vpi-chevron-right caret-icon" data-v-145eeefe></span></div></div><div class="items" data-v-145eeefe><!--[--><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/architecture/API_NAMING_CONVENTION.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>API å‘½åè§„èŒƒ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/architecture/BUSINESS_CODES.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>ä¸šåŠ¡çŠ¶æ€ç </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/architecture/VALIDATION_PIPE_CONFIG.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>éªŒè¯ç®¡é“é…ç½®</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/architecture/REDIS_ANALYSIS.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>Redis åˆ†æ</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-337849fc><section class="VPSidebarItem level-0 collapsible collapsed" data-v-337849fc data-v-145eeefe><div class="item" role="button" tabindex="0" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><h2 class="text" data-v-145eeefe>åŠŸèƒ½ç‰¹æ€§</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-145eeefe><span class="vpi-chevron-right caret-icon" data-v-145eeefe></span></div></div><div class="items" data-v-145eeefe><!--[--><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/features/NEW_PERMISSION_SYSTEM.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>æ–°æƒé™ç³»ç»Ÿ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/features/TOKEN_IMPLEMENTATION_SUMMARY.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>Token å®ç°</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/features/LOGGING_SYSTEM_RELEASE.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>æ—¥å¿—ç³»ç»Ÿ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/features/CONTENT_MANAGEMENT_MODULE.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>å†…å®¹ç®¡ç†</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-337849fc><section class="VPSidebarItem level-0 collapsible collapsed" data-v-337849fc data-v-145eeefe><div class="item" role="button" tabindex="0" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><h2 class="text" data-v-145eeefe>å¼€å‘æŒ‡å—</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-145eeefe><span class="vpi-chevron-right caret-icon" data-v-145eeefe></span></div></div><div class="items" data-v-145eeefe><!--[--><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/guides/users-module.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>ç”¨æˆ·æ¨¡å—</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/guides/projects-module.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>é¡¹ç›®æ¨¡å—</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/guides/CMS_API_GUIDE.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>CMS API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/guides/MENU_MANAGEMENT.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>èœå•ç®¡ç†</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/guides/AUDIT_USAGE.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>å®¡è®¡æ—¥å¿—</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-337849fc><section class="VPSidebarItem level-0 collapsible collapsed" data-v-337849fc data-v-145eeefe><div class="item" role="button" tabindex="0" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><h2 class="text" data-v-145eeefe>æ•°æ®åº“è¿ç§»</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-145eeefe><span class="vpi-chevron-right caret-icon" data-v-145eeefe></span></div></div><div class="items" data-v-145eeefe><!--[--><div class="VPSidebarItem level-1 is-link" data-v-145eeefe data-v-145eeefe><div class="item" data-v-145eeefe><div class="indicator" data-v-145eeefe></div><a class="VPLink link link" href="/nestBase/backend/migrations/MIGRATION_GUIDE.html" data-v-145eeefe><!--[--><p class="text" data-v-145eeefe>è¿ç§»æŒ‡å—</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-c5b340f5 data-v-088b497b><div class="VPDoc has-sidebar has-aside" data-v-088b497b data-v-af74e104><!--[--><!--]--><div class="container" data-v-af74e104><div class="aside" data-v-af74e104><div class="aside-curtain" data-v-af74e104></div><div class="aside-container" data-v-af74e104><div class="aside-content" data-v-af74e104><div class="VPDocAside" data-v-af74e104 data-v-5700a071><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-5700a071 data-v-a3653095><div class="content" data-v-a3653095><div class="outline-marker" data-v-a3653095></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a3653095>On this page</div><ul class="VPDocOutlineItem root" data-v-a3653095 data-v-3554fc2f><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-5700a071></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-af74e104><div class="content-container" data-v-af74e104><!--[--><!--]--><main class="main" data-v-af74e104><div style="position:relative;" class="vp-doc _nestBase_backend_features_REFACTOR_USER_ROLES_INTEGRATION" data-v-af74e104><div><h1 id="ç”¨æˆ·è§’è‰²ç®¡ç†ç»Ÿä¸€åŒ–é‡æ„æ–‡æ¡£" tabindex="-1">ç”¨æˆ·è§’è‰²ç®¡ç†ç»Ÿä¸€åŒ–é‡æ„æ–‡æ¡£ <a class="header-anchor" href="#ç”¨æˆ·è§’è‰²ç®¡ç†ç»Ÿä¸€åŒ–é‡æ„æ–‡æ¡£" aria-label="Permalink to &quot;ç”¨æˆ·è§’è‰²ç®¡ç†ç»Ÿä¸€åŒ–é‡æ„æ–‡æ¡£&quot;">â€‹</a></h1><blockquote><p><strong>é‡æ„æ—¥æœŸ</strong>: 2025-01-06 <strong>é‡æ„ç±»å‹</strong>: æœåŠ¡å¤ç”¨ &amp; å®¡è®¡æ—¥å¿—ç»Ÿä¸€ <strong>å½±å“èŒƒå›´</strong>: Users æ¨¡å—ã€UserRoles æ¨¡å— <strong>ç‰ˆæœ¬</strong>: v1.1.0</p></blockquote><hr><h2 id="ğŸ“‹-ç›®å½•" tabindex="-1">ğŸ“‹ ç›®å½• <a class="header-anchor" href="#ğŸ“‹-ç›®å½•" aria-label="Permalink to &quot;ğŸ“‹ ç›®å½•&quot;">â€‹</a></h2><ul><li><a href="#èƒŒæ™¯">èƒŒæ™¯</a></li><li><a href="#é—®é¢˜åˆ†æ">é—®é¢˜åˆ†æ</a></li><li><a href="#è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</a></li><li><a href="#å®æ–½ç»†èŠ‚">å®æ–½ç»†èŠ‚</a></li><li><a href="#æµ‹è¯•éªŒè¯">æµ‹è¯•éªŒè¯</a></li><li><a href="#å½±å“è¯„ä¼°">å½±å“è¯„ä¼°</a></li><li><a href="#å›æ»šæ–¹æ¡ˆ">å›æ»šæ–¹æ¡ˆ</a></li></ul><hr><h2 id="ğŸ¯-èƒŒæ™¯" tabindex="-1">ğŸ¯ èƒŒæ™¯ <a class="header-anchor" href="#ğŸ¯-èƒŒæ™¯" aria-label="Permalink to &quot;ğŸ¯ èƒŒæ™¯&quot;">â€‹</a></h2><h3 id="åŸæœ‰æ¶æ„" tabindex="-1">åŸæœ‰æ¶æ„ <a class="header-anchor" href="#åŸæœ‰æ¶æ„" aria-label="Permalink to &quot;åŸæœ‰æ¶æ„&quot;">â€‹</a></h3><p>åœ¨é‡æ„å‰ï¼Œé¡¹ç›®ä¸­å­˜åœ¨ä¸¤ä¸ªæ¨¡å—éƒ½èƒ½ä¿®æ”¹ç”¨æˆ·è§’è‰²ï¼š</p><ol><li><p><strong>Users æ¨¡å—</strong> (<code>src/modules/users/</code>)</p><ul><li><code>PATCH /api/users/:id</code> - æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼ˆåŒ…å«è§’è‰²ï¼‰</li><li>å®ç°ä½ç½®: <code>users.service.ts::update()</code></li></ul></li><li><p><strong>UserRoles æ¨¡å—</strong> (<code>src/modules/user-roles/</code>)</p><ul><li><code>PUT /api/users/:id/roles</code> - ä¸“é—¨è®¾ç½®ç”¨æˆ·è§’è‰²</li><li>å®ç°ä½ç½®: <code>user-roles.service.ts::setUserRoles()</code></li></ul></li></ol><h3 id="å‘ç°çš„é—®é¢˜" tabindex="-1">å‘ç°çš„é—®é¢˜ <a class="header-anchor" href="#å‘ç°çš„é—®é¢˜" aria-label="Permalink to &quot;å‘ç°çš„é—®é¢˜&quot;">â€‹</a></h3><p>ç»è¿‡ä»£ç å®¡æŸ¥ï¼Œå‘ç°å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p><table tabindex="0"><thead><tr><th>é—®é¢˜</th><th>æè¿°</th><th>ä¸¥é‡ç¨‹åº¦</th></tr></thead><tbody><tr><td><strong>åŠŸèƒ½é‡å¤</strong></td><td>ä¸¤ä¸ªæ¨¡å—éƒ½å®ç°äº†è§’è‰²æ›´æ–°é€»è¾‘</td><td>ğŸŸ¡ ä¸­</td></tr><tr><td><strong>å®¡è®¡æ—¥å¿—ä¸ä¸€è‡´</strong></td><td>Users æ¨¡å—æ— å®¡è®¡æ—¥å¿—ï¼ŒUserRoles æ¨¡å—æœ‰</td><td>ğŸ”´ é«˜</td></tr><tr><td><strong>ç»´æŠ¤æˆæœ¬é«˜</strong></td><td>ç›¸åŒé€»è¾‘éœ€è¦åœ¨ä¸¤å¤„ç»´æŠ¤</td><td>ğŸŸ¡ ä¸­</td></tr><tr><td><strong>é™æµä¸ä¸€è‡´</strong></td><td>UserRoles æœ‰é™æµä¿æŠ¤ï¼ŒUsers æ¨¡å—æ— </td><td>ğŸŸ¡ ä¸­</td></tr><tr><td><strong>èŒè´£ä¸æ¸…</strong></td><td>å‰ç«¯å¼€å‘è€…ä¸æ¸…æ¥šè¯¥ä½¿ç”¨å“ªä¸ªæ¥å£</td><td>ğŸŸ¡ ä¸­</td></tr></tbody></table><hr><h2 id="ğŸ”-é—®é¢˜åˆ†æ" tabindex="-1">ğŸ” é—®é¢˜åˆ†æ <a class="header-anchor" href="#ğŸ”-é—®é¢˜åˆ†æ" aria-label="Permalink to &quot;ğŸ” é—®é¢˜åˆ†æ&quot;">â€‹</a></h2><h3 id="ä»£ç å¯¹æ¯”" tabindex="-1">ä»£ç å¯¹æ¯” <a class="header-anchor" href="#ä»£ç å¯¹æ¯”" aria-label="Permalink to &quot;ä»£ç å¯¹æ¯”&quot;">â€‹</a></h3><h4 id="users-æ¨¡å—çš„è§’è‰²æ›´æ–°é€»è¾‘-é‡æ„å‰" tabindex="-1">Users æ¨¡å—çš„è§’è‰²æ›´æ–°é€»è¾‘ (é‡æ„å‰) <a class="header-anchor" href="#users-æ¨¡å—çš„è§’è‰²æ›´æ–°é€»è¾‘-é‡æ„å‰" aria-label="Permalink to &quot;Users æ¨¡å—çš„è§’è‰²æ›´æ–°é€»è¾‘ (é‡æ„å‰)&quot;">â€‹</a></h4><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// users.service.ts::update() - ç¬¬ 363-416 è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">async </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id: string, updateUserDto: UpdateUserDto) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ... ç”¨æˆ·åŸºæœ¬ä¿¡æ¯éªŒè¯å’Œæ›´æ–° ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¤„ç†è§’è‰²æ›´æ–°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (updateUserDto.roleIds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // éªŒè¯è§’è‰²IDæ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> roles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.prisma.role.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      where: { id: { in: updateUserDto.roleIds } },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (roles.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> updateUserDto.roleIds.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BadRequestException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;éƒ¨åˆ†è§’è‰² ID ä¸å­˜åœ¨&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ä½¿ç”¨äº‹åŠ¡æ›´æ–°ç”¨æˆ·å’Œè§’è‰²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.prisma.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$transaction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">prisma</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> updatedUser</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      where: { id },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      data: updateData,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // åˆ é™¤ç°æœ‰è§’è‰²å…³è”</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.userRole.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deleteMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ where: { userId: id } });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // åˆ›å»ºæ–°çš„è§’è‰²å…³è”</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (updateUserDto.roleIds.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.userRole.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        data: updateUserDto.roleIds.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">roleId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          userId: id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          roleId,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> updatedUser;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // âŒ æ²¡æœ‰å®¡è®¡æ—¥å¿—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">formatUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="userroles-æ¨¡å—çš„è§’è‰²æ›´æ–°é€»è¾‘" tabindex="-1">UserRoles æ¨¡å—çš„è§’è‰²æ›´æ–°é€»è¾‘ <a class="header-anchor" href="#userroles-æ¨¡å—çš„è§’è‰²æ›´æ–°é€»è¾‘" aria-label="Permalink to &quot;UserRoles æ¨¡å—çš„è§’è‰²æ›´æ–°é€»è¾‘&quot;">â€‹</a></h4><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// user-roles.service.ts::setUserRoles() - ç¬¬ 62-131 è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">async </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setUserRoles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userId: string, roleIds: string[], actorId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> string) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // éªŒè¯ç”¨æˆ·å’Œè§’è‰²</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // è·å–å˜æ›´å‰çš„è§’è‰²ï¼ˆç”¨äºå®¡è®¡ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> beforeRoles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getUserRoles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userId);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ä½¿ç”¨äº‹åŠ¡æ›´æ–°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.prisma.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$transaction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">tx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tx.userRole.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deleteMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ where: { userId } });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (roleIds.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tx.userRole.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        data: roleIds.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">roleId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({ userId, roleId })),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // âœ… è®°å½•å®¡è®¡æ—¥å¿—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.audit.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    event: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;user.roles.set&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    userId: actorId,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    resource: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;User&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    resourceId: userId,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    action: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;UPDATE&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    payload: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      actorId,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      userId,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      before: beforeRoles.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r.id),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      after: roleIds,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { userId, roleIds, message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ç”¨æˆ·è§’è‰²è®¾ç½®æˆåŠŸ&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="å·®å¼‚æ€»ç»“" tabindex="-1">å·®å¼‚æ€»ç»“ <a class="header-anchor" href="#å·®å¼‚æ€»ç»“" aria-label="Permalink to &quot;å·®å¼‚æ€»ç»“&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>ç‰¹æ€§</th><th>Users æ¨¡å—</th><th>UserRoles æ¨¡å—</th></tr></thead><tbody><tr><td>éªŒè¯é€»è¾‘</td><td>âœ… éªŒè¯è§’è‰²å­˜åœ¨</td><td>âœ… éªŒè¯è§’è‰²å­˜åœ¨</td></tr><tr><td>äº‹åŠ¡å¤„ç†</td><td>âœ… ä½¿ç”¨äº‹åŠ¡</td><td>âœ… ä½¿ç”¨äº‹åŠ¡</td></tr><tr><td>å®¡è®¡æ—¥å¿—</td><td>âŒ æ— </td><td>âœ… æœ‰ (before/after)</td></tr><tr><td>é™æµä¿æŠ¤</td><td>âŒ æ— </td><td>âœ… æœ‰ (10æ¬¡/åˆ†é’Ÿ)</td></tr><tr><td>æƒé™æ§åˆ¶</td><td>ä»… ADMIN è§’è‰²</td><td>ADMIN + <code>user.update</code></td></tr><tr><td>æ“ä½œè€…è®°å½•</td><td>âŒ ä¸è®°å½•</td><td>âœ… è®°å½• actorId</td></tr></tbody></table><hr><h2 id="ğŸ’¡-è§£å†³æ–¹æ¡ˆ" tabindex="-1">ğŸ’¡ è§£å†³æ–¹æ¡ˆ <a class="header-anchor" href="#ğŸ’¡-è§£å†³æ–¹æ¡ˆ" aria-label="Permalink to &quot;ğŸ’¡ è§£å†³æ–¹æ¡ˆ&quot;">â€‹</a></h2><h3 id="æ–¹æ¡ˆé€‰æ‹©" tabindex="-1">æ–¹æ¡ˆé€‰æ‹© <a class="header-anchor" href="#æ–¹æ¡ˆé€‰æ‹©" aria-label="Permalink to &quot;æ–¹æ¡ˆé€‰æ‹©&quot;">â€‹</a></h3><p>ç»è¿‡è®¨è®ºï¼Œé€‰æ‹©äº† <strong>æ–¹æ¡ˆBï¼šæœåŠ¡å¤ç”¨</strong></p><h4 id="æ–¹æ¡ˆå¯¹æ¯”" tabindex="-1">æ–¹æ¡ˆå¯¹æ¯” <a class="header-anchor" href="#æ–¹æ¡ˆå¯¹æ¯”" aria-label="Permalink to &quot;æ–¹æ¡ˆå¯¹æ¯”&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ¡ˆ</th><th>æè¿°</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‰æ‹©</th></tr></thead><tbody><tr><td><strong>æ–¹æ¡ˆA</strong></td><td>Users æ¨¡å—ç§»é™¤è§’è‰²æ›´æ–°åŠŸèƒ½</td><td>èŒè´£æ¸…æ™°</td><td>å‰ç«¯éœ€è¦ä¿®æ”¹</td><td>âŒ</td></tr><tr><td><strong>æ–¹æ¡ˆB</strong></td><td>Users æ¨¡å—è°ƒç”¨ UserRoles æœåŠ¡</td><td>å‰ç«¯æ— éœ€ä¿®æ”¹</td><td>å¢åŠ æ¨¡å—ä¾èµ–</td><td>âœ…</td></tr><tr><td><strong>æ–¹æ¡ˆC</strong></td><td>åºŸå¼ƒ UserRoles æ¨¡å—</td><td>å‡å°‘æ¨¡å—æ•°</td><td>å¤±å»å®¡è®¡æ—¥å¿—</td><td>âŒ</td></tr></tbody></table><h4 id="é€‰æ‹©ç†ç”±" tabindex="-1">é€‰æ‹©ç†ç”± <a class="header-anchor" href="#é€‰æ‹©ç†ç”±" aria-label="Permalink to &quot;é€‰æ‹©ç†ç”±&quot;">â€‹</a></h4><ol><li><strong>å‰ç«¯å…¼å®¹æ€§</strong>: ä¿æŒç°æœ‰ API ä¸å˜ï¼Œæ— éœ€ä¿®æ”¹å‰ç«¯ä»£ç </li><li><strong>å®¡è®¡ç»Ÿä¸€</strong>: æ‰€æœ‰è§’è‰²å˜æ›´éƒ½é€šè¿‡ UserRolesServiceï¼Œè‡ªåŠ¨è®°å½•å®¡è®¡æ—¥å¿—</li><li><strong>ä»£ç å¤ç”¨</strong>: é¿å…ç»´æŠ¤ä¸¤å¥—ç›¸åŒé€»è¾‘</li><li><strong>æ¸è¿›å¼é‡æ„</strong>: ä¸ç ´åç°æœ‰åŠŸèƒ½ï¼Œé£é™©å¯æ§</li></ol><hr><h2 id="ğŸ”§-å®æ–½ç»†èŠ‚" tabindex="-1">ğŸ”§ å®æ–½ç»†èŠ‚ <a class="header-anchor" href="#ğŸ”§-å®æ–½ç»†èŠ‚" aria-label="Permalink to &quot;ğŸ”§ å®æ–½ç»†èŠ‚&quot;">â€‹</a></h2><h3 id="ä¿®æ”¹æ–‡ä»¶æ¸…å•" tabindex="-1">ä¿®æ”¹æ–‡ä»¶æ¸…å• <a class="header-anchor" href="#ä¿®æ”¹æ–‡ä»¶æ¸…å•" aria-label="Permalink to &quot;ä¿®æ”¹æ–‡ä»¶æ¸…å•&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>#</th><th>æ–‡ä»¶è·¯å¾„</th><th>ä¿®æ”¹ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>1</td><td><code>src/modules/user-roles/user-roles.module.ts</code></td><td>å¯¼å‡ºæœåŠ¡</td><td>æ·»åŠ  <code>exports: [UserRolesService]</code></td></tr><tr><td>2</td><td><code>src/modules/users/users.module.ts</code></td><td>å¯¼å…¥æ¨¡å—</td><td>æ·»åŠ  <code>imports: [UserRolesModule]</code></td></tr><tr><td>3</td><td><code>src/modules/users/users.service.ts</code></td><td>é‡æ„é€»è¾‘</td><td>æ³¨å…¥å¹¶è°ƒç”¨ UserRolesService</td></tr><tr><td>4</td><td><code>src/modules/users/users.controller.ts</code></td><td>ä¼ é€’å‚æ•°</td><td>ä¼ é€’ currentUser.id ç»™æœåŠ¡å±‚</td></tr></tbody></table><hr><h3 id="_1-ä¿®æ”¹-user-roles-module-ts" tabindex="-1">1. ä¿®æ”¹ user-roles.module.ts <a class="header-anchor" href="#_1-ä¿®æ”¹-user-roles-module-ts" aria-label="Permalink to &quot;1. ä¿®æ”¹ user-roles.module.ts&quot;">â€‹</a></h3><p><strong>æ–‡ä»¶</strong>: <code>src/modules/user-roles/user-roles.module.ts</code></p><p><strong>ä¿®æ”¹å†…å®¹</strong>:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  imports: [PrismaModule, AuditModule],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  controllers: [UserRolesUsersController, UserRolesRolesController],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  providers: [UserRolesService],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  exports: [UserRolesService], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… æ–°å¢ï¼šå¯¼å‡ºæœåŠ¡ä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserRolesModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span></code></pre></div><p><strong>ä¿®æ”¹ç†ç”±</strong>:</p><ul><li>å¯¼å‡º <code>UserRolesService</code> ä½¿å…¶å¯ä»¥è¢«å…¶ä»–æ¨¡å—æ³¨å…¥ä½¿ç”¨</li><li>éµå¾ª NestJS æ¨¡å—åŒ–è®¾è®¡åŸåˆ™</li></ul><p><strong>å½±å“èŒƒå›´</strong>: æ— ç ´åæ€§å˜æ›´</p><hr><h3 id="_2-ä¿®æ”¹-users-module-ts" tabindex="-1">2. ä¿®æ”¹ users.module.ts <a class="header-anchor" href="#_2-ä¿®æ”¹-users-module-ts" aria-label="Permalink to &quot;2. ä¿®æ”¹ users.module.ts&quot;">â€‹</a></h3><p><strong>æ–‡ä»¶</strong>: <code>src/modules/users/users.module.ts</code></p><p><strong>ä¿®æ”¹å†…å®¹</strong>:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Module } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@nestjs/common&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { UsersService } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./users.service&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { UsersController } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./users.controller&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { UserRolesModule } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;../user-roles/user-roles.module&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… æ–°å¢å¯¼å…¥</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  imports: [UserRolesModule], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… æ–°å¢ï¼šå¯¼å…¥ UserRolesModule</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  controllers: [UsersController],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  providers: [UsersService],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  exports: [UsersService],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UsersModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span></code></pre></div><p><strong>ä¿®æ”¹ç†ç”±</strong>:</p><ul><li>å¯¼å…¥ <code>UserRolesModule</code> ä»¥è·å– <code>UserRolesService</code> çš„ä¾èµ–</li><li>å»ºç«‹æ¨¡å—é—´ä¾èµ–å…³ç³»</li></ul><p><strong>å½±å“èŒƒå›´</strong>: æ— ç ´åæ€§å˜æ›´</p><hr><h3 id="_3-ä¿®æ”¹-users-service-ts" tabindex="-1">3. ä¿®æ”¹ users.service.ts <a class="header-anchor" href="#_3-ä¿®æ”¹-users-service-ts" aria-label="Permalink to &quot;3. ä¿®æ”¹ users.service.ts&quot;">â€‹</a></h3><p><strong>æ–‡ä»¶</strong>: <code>src/modules/users/users.service.ts</code></p><h4 id="_3-1-æ·»åŠ ä¾èµ–æ³¨å…¥" tabindex="-1">3.1 æ·»åŠ ä¾èµ–æ³¨å…¥ <a class="header-anchor" href="#_3-1-æ·»åŠ ä¾èµ–æ³¨å…¥" aria-label="Permalink to &quot;3.1 æ·»åŠ ä¾èµ–æ³¨å…¥&quot;">â€‹</a></h4><p><strong>ä¿®æ”¹å†…å®¹</strong>:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { UserRolesService } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;../user-roles/user-roles.service&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… æ–°å¢å¯¼å…¥</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Injectable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UsersService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> prisma</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PrismaService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> userRolesService</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserRolesService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… æ–°å¢æ³¨å…¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ) {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="_3-2-é‡æ„-update-æ–¹æ³•" tabindex="-1">3.2 é‡æ„ update() æ–¹æ³• <a class="header-anchor" href="#_3-2-é‡æ„-update-æ–¹æ³•" aria-label="Permalink to &quot;3.2 é‡æ„ update() æ–¹æ³•&quot;">â€‹</a></h4><p><strong>ä¿®æ”¹å‰</strong> (ç¬¬ 301-419 è¡Œ):</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">async </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id: string, updateUserDto: UpdateUserDto) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ... éªŒè¯å’Œå‡†å¤‡æ›´æ–°æ•°æ® ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¤„ç†è§’è‰²æ›´æ–°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (updateUserDto.roleIds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // éªŒè¯è§’è‰²ID</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> roles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.prisma.role.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      where: { id: { in: updateUserDto.roleIds } },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (roles.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> updateUserDto.roleIds.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BadRequestException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;éƒ¨åˆ†è§’è‰² ID ä¸å­˜åœ¨&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ä½¿ç”¨äº‹åŠ¡æ›´æ–°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.prisma.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$transaction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">prisma</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> updatedUser</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      where: { id },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      data: updateData,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (updateUserDto.roleIds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.userRole.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deleteMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ where: { userId: id } });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (updateUserDto.roleIds.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.userRole.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          data: updateUserDto.roleIds.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">roleId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            userId: id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            roleId,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          })),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findUnique</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        where: { id },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        select: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.userSelect,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> updatedUser;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">formatUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>ä¿®æ”¹å</strong> (ç¬¬ 305-385 è¡Œ):</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">async </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id: string, updateUserDto: UpdateUserDto, actorId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> string) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… æ–°å¢ actorId å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> existingUser</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.prisma.user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findUnique</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    where: { id },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">existingUser) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NotFoundException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`ç”¨æˆ· ID ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} ä¸å­˜åœ¨`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      code: BusinessCode.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">USER_NOT_FOUND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å‡†å¤‡æ›´æ–°æ•°æ®ï¼ˆnickName, phone, gender, etc.ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> updateData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ... å¤„ç†å„ä¸ªå­—æ®µ ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // âœ… æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.prisma.user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    where: { id },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    data: updateData,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // âœ… å¦‚æœéœ€è¦æ›´æ–°è§’è‰²ï¼Œè°ƒç”¨ UserRolesServiceï¼ˆç»Ÿä¸€å®¡è®¡æ—¥å¿—ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (updateUserDto.roleIds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.userRolesService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setUserRoles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id, updateUserDto.roleIds, actorId);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // âœ… é‡æ–°æŸ¥è¯¢ç”¨æˆ·ä»¥è·å–æœ€æ–°æ•°æ®ï¼ˆåŒ…æ‹¬è§’è‰²ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> updatedUser</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.prisma.user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findUnique</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    where: { id },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    select: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.userSelect,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">formatUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(updatedUser);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>æ ¸å¿ƒå˜æ›´</strong>:</p><ol><li>âœ… æ·»åŠ  <code>actorId?: string</code> å‚æ•°ç”¨äºå®¡è®¡æ—¥å¿—</li><li>âŒ ç§»é™¤è§’è‰²éªŒè¯é€»è¾‘ï¼ˆç”± UserRolesService å¤„ç†ï¼‰</li><li>âŒ ç§»é™¤äº‹åŠ¡ä¸­çš„è§’è‰²æ›´æ–°é€»è¾‘</li><li>âœ… è°ƒç”¨ <code>userRolesService.setUserRoles()</code> å¤„ç†è§’è‰²</li><li>âœ… åˆ†ç¦»åŸºæœ¬ä¿¡æ¯æ›´æ–°å’Œè§’è‰²æ›´æ–°</li></ol><p><strong>ä¿®æ”¹ç†ç”±</strong>:</p><ul><li><strong>ç»Ÿä¸€å®¡è®¡</strong>: é€šè¿‡ UserRolesService è‡ªåŠ¨è®°å½•å®¡è®¡æ—¥å¿—</li><li><strong>ä»£ç å¤ç”¨</strong>: é¿å…é‡å¤å®ç°è§’è‰²éªŒè¯å’Œæ›´æ–°é€»è¾‘</li><li><strong>èŒè´£åˆ†ç¦»</strong>: Users æ¨¡å—ä¸“æ³¨ç”¨æˆ·ä¿¡æ¯ï¼ŒUserRoles æ¨¡å—ä¸“æ³¨è§’è‰²å…³ç³»</li><li><strong>è¿½æº¯æ€§</strong>: è®°å½•æ“ä½œè€… ID (actorId)</li></ul><hr><h3 id="_4-ä¿®æ”¹-users-controller-ts" tabindex="-1">4. ä¿®æ”¹ users.controller.ts <a class="header-anchor" href="#_4-ä¿®æ”¹-users-controller-ts" aria-label="Permalink to &quot;4. ä¿®æ”¹ users.controller.ts&quot;">â€‹</a></h3><p><strong>æ–‡ä»¶</strong>: <code>src/modules/users/users.controller.ts</code></p><h4 id="_4-1-æ·»åŠ è£…é¥°å™¨å¯¼å…¥" tabindex="-1">4.1 æ·»åŠ è£…é¥°å™¨å¯¼å…¥ <a class="header-anchor" href="#_4-1-æ·»åŠ è£…é¥°å™¨å¯¼å…¥" aria-label="Permalink to &quot;4.1 æ·»åŠ è£…é¥°å™¨å¯¼å…¥&quot;">â€‹</a></h4><p><strong>ä¿®æ”¹å†…å®¹</strong>:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Roles, CurrentUser } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@common/decorators&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… æ–°å¢ CurrentUser</span></span></code></pre></div><h4 id="_4-2-ä¿®æ”¹-update-æ–¹æ³•" tabindex="-1">4.2 ä¿®æ”¹ update() æ–¹æ³• <a class="header-anchor" href="#_4-2-ä¿®æ”¹-update-æ–¹æ³•" aria-label="Permalink to &quot;4.2 ä¿®æ”¹ update() æ–¹æ³•&quot;">â€‹</a></h4><p><strong>ä¿®æ”¹å‰</strong> (ç¬¬ 57-65 è¡Œ):</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Patch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;:id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Roles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ADMIN&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ApiOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ summary: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼ˆä»…ç®¡ç†å‘˜ï¼‰&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ApiResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ status: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, description: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;æ›´æ–°æˆåŠŸ&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ApiResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ status: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">403</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, description: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;æƒé™ä¸è¶³&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ApiResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ status: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">404</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, description: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ç”¨æˆ·ä¸å­˜åœ¨&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) id: string, @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() updateUserDto: UpdateUserDto) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.usersService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id, updateUserDto);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>ä¿®æ”¹å</strong> (ç¬¬ 57-69 è¡Œ):</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Patch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;:id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Roles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ADMIN&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ApiOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ summary: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼ˆä»…ç®¡ç†å‘˜ï¼‰&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ApiResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ status: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, description: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;æ›´æ–°æˆåŠŸ&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ApiResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ status: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">403</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, description: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;æƒé™ä¸è¶³&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ApiResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ status: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">404</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, description: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ç”¨æˆ·ä¸å­˜åœ¨&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) id: string,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() updateUserDto: UpdateUserDto,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CurrentUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() currentUser: any, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… æ–°å¢ï¼šè·å–å½“å‰ç™»å½•ç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.usersService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id, updateUserDto, currentUser?.id); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… ä¼ é€’ actorId</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>ä¿®æ”¹ç†ç”±</strong>:</p><ul><li>é€šè¿‡ <code>@CurrentUser()</code> è£…é¥°å™¨è·å–å½“å‰ç™»å½•ç”¨æˆ·</li><li>ä¼ é€’ <code>currentUser.id</code> ä½œä¸º <code>actorId</code> ç”¨äºå®¡è®¡æ—¥å¿—</li><li>è®°å½•&quot;è°&quot;ä¿®æ”¹äº†ç”¨æˆ·è§’è‰²</li></ul><hr><h2 id="ğŸ”„-æ•°æ®æµå¯¹æ¯”" tabindex="-1">ğŸ”„ æ•°æ®æµå¯¹æ¯” <a class="header-anchor" href="#ğŸ”„-æ•°æ®æµå¯¹æ¯”" aria-label="Permalink to &quot;ğŸ”„ æ•°æ®æµå¯¹æ¯”&quot;">â€‹</a></h2><h3 id="é‡æ„å‰çš„æ•°æ®æµ" tabindex="-1">é‡æ„å‰çš„æ•°æ®æµ <a class="header-anchor" href="#é‡æ„å‰çš„æ•°æ®æµ" aria-label="Permalink to &quot;é‡æ„å‰çš„æ•°æ®æµ&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚ PATCH /api/users/:id { roleIds: [...] }    â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span>
<span class="line"><span>                   â”‚</span></span>
<span class="line"><span>                   â–¼</span></span>
<span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚ UsersController.update()                    â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span>
<span class="line"><span>                   â”‚</span></span>
<span class="line"><span>                   â–¼</span></span>
<span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚ UsersService.update(id, dto)                â”‚</span></span>
<span class="line"><span>â”‚ â”œâ”€ éªŒè¯ç”¨æˆ·å­˜åœ¨                            â”‚</span></span>
<span class="line"><span>â”‚ â”œâ”€ éªŒè¯è§’è‰²å­˜åœ¨                            â”‚</span></span>
<span class="line"><span>â”‚ â””â”€ äº‹åŠ¡ï¼š                                  â”‚</span></span>
<span class="line"><span>â”‚    â”œâ”€ æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯                     â”‚</span></span>
<span class="line"><span>â”‚    â”œâ”€ åˆ é™¤æ—§è§’è‰²å…³è”                       â”‚</span></span>
<span class="line"><span>â”‚    â””â”€ åˆ›å»ºæ–°è§’è‰²å…³è”                       â”‚</span></span>
<span class="line"><span>â”‚                                             â”‚</span></span>
<span class="line"><span>â”‚ âŒ æ— å®¡è®¡æ—¥å¿—                              â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span></code></pre></div><h3 id="é‡æ„åçš„æ•°æ®æµ" tabindex="-1">é‡æ„åçš„æ•°æ®æµ <a class="header-anchor" href="#é‡æ„åçš„æ•°æ®æµ" aria-label="Permalink to &quot;é‡æ„åçš„æ•°æ®æµ&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚ PATCH /api/users/:id { roleIds: [...] }    â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span>
<span class="line"><span>                   â”‚</span></span>
<span class="line"><span>                   â–¼</span></span>
<span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚ UsersController.update()                    â”‚</span></span>
<span class="line"><span>â”‚ â”œâ”€ æå– @CurrentUser() â†’ actorId          â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span>
<span class="line"><span>                   â”‚</span></span>
<span class="line"><span>                   â–¼</span></span>
<span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚ UsersService.update(id, dto, actorId)       â”‚</span></span>
<span class="line"><span>â”‚ â”œâ”€ éªŒè¯ç”¨æˆ·å­˜åœ¨                            â”‚</span></span>
<span class="line"><span>â”‚ â”œâ”€ æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯                        â”‚</span></span>
<span class="line"><span>â”‚ â”œâ”€ if (roleIds !== undefined)              â”‚</span></span>
<span class="line"><span>â”‚ â”‚  â””â”€&gt; è°ƒç”¨ UserRolesService â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚</span></span>
<span class="line"><span>â”‚ â””â”€ é‡æ–°æŸ¥è¯¢ç”¨æˆ·ï¼ˆå«è§’è‰²ï¼‰              â”‚   â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”˜</span></span>
<span class="line"><span>                                         â”‚</span></span>
<span class="line"><span>                                         â–¼</span></span>
<span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚ UserRolesService.setUserRoles()             â”‚</span></span>
<span class="line"><span>â”‚ â”œâ”€ éªŒè¯ç”¨æˆ·å’Œè§’è‰²å­˜åœ¨                      â”‚</span></span>
<span class="line"><span>â”‚ â”œâ”€ è·å–å˜æ›´å‰çš„è§’è‰²ï¼ˆç”¨äºå®¡è®¡ï¼‰            â”‚</span></span>
<span class="line"><span>â”‚ â”œâ”€ äº‹åŠ¡ï¼š                                  â”‚</span></span>
<span class="line"><span>â”‚ â”‚  â”œâ”€ åˆ é™¤æ—§è§’è‰²å…³è”                       â”‚</span></span>
<span class="line"><span>â”‚ â”‚  â””â”€ åˆ›å»ºæ–°è§’è‰²å…³è”                       â”‚</span></span>
<span class="line"><span>â”‚ â””â”€ âœ… è®°å½•å®¡è®¡æ—¥å¿—:                        â”‚</span></span>
<span class="line"><span>â”‚    â”œâ”€ event: &#39;user.roles.set&#39;              â”‚</span></span>
<span class="line"><span>â”‚    â”œâ”€ userId: actorId                      â”‚</span></span>
<span class="line"><span>â”‚    â”œâ”€ resource: &#39;User&#39;                     â”‚</span></span>
<span class="line"><span>â”‚    â”œâ”€ resourceId: userId                   â”‚</span></span>
<span class="line"><span>â”‚    â””â”€ payload: { before, after }           â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span></code></pre></div><hr><h2 id="âœ…-æµ‹è¯•éªŒè¯" tabindex="-1">âœ… æµ‹è¯•éªŒè¯ <a class="header-anchor" href="#âœ…-æµ‹è¯•éªŒè¯" aria-label="Permalink to &quot;âœ… æµ‹è¯•éªŒè¯&quot;">â€‹</a></h2><h3 id="ç¼–è¯‘æ£€æŸ¥" tabindex="-1">ç¼–è¯‘æ£€æŸ¥ <a class="header-anchor" href="#ç¼–è¯‘æ£€æŸ¥" aria-label="Permalink to &quot;ç¼–è¯‘æ£€æŸ¥&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç±»å‹æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apps/backend</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tsc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --noEmit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç»“æœ: âœ… é€šè¿‡ï¼Œæ— ç±»å‹é”™è¯¯</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ„å»ºæµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --filter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç»“æœ: âœ… æˆåŠŸ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># webpack 5.97.1 compiled successfully in 2051 ms</span></span></code></pre></div><h3 id="åŠŸèƒ½æµ‹è¯•æ¸…å•" tabindex="-1">åŠŸèƒ½æµ‹è¯•æ¸…å• <a class="header-anchor" href="#åŠŸèƒ½æµ‹è¯•æ¸…å•" aria-label="Permalink to &quot;åŠŸèƒ½æµ‹è¯•æ¸…å•&quot;">â€‹</a></h3><h4 id="_1-æµ‹è¯•-patch-api-users-id-æ›´æ–°è§’è‰²" tabindex="-1">1. æµ‹è¯• PATCH /api/users/:id æ›´æ–°è§’è‰² <a class="header-anchor" href="#_1-æµ‹è¯•-patch-api-users-id-æ›´æ–°è§’è‰²" aria-label="Permalink to &quot;1. æµ‹è¯• PATCH /api/users/:id æ›´æ–°è§’è‰²&quot;">â€‹</a></h4><p><strong>æµ‹è¯•æ­¥éª¤</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. ç™»å½•è·å– token</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:3000/api/auth/login</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type: application/json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;email&quot;:&quot;admin@example.com&quot;,&quot;password&quot;:&quot;admin123&quot;}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. è·å–ç”¨æˆ·å½“å‰è§’è‰²</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:3000/api/users/{userId}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer {token}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. æ›´æ–°ç”¨æˆ·è§’è‰²</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PATCH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:3000/api/users/{userId}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer {token}&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type: application/json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;nickName&quot;: &quot;æµ‹è¯•ç”¨æˆ·&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;roleIds&quot;: [&quot;role-id-1&quot;, &quot;role-id-2&quot;]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. æŸ¥è¯¢å®¡è®¡æ—¥å¿—ï¼ˆæ•°æ®åº“ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> audit_logs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> event</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;user.roles.set&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  AND</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resource_id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{userId}&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ORDER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> created_at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DESC</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><strong>é¢„æœŸç»“æœ</strong>:</p><ul><li>âœ… ç”¨æˆ·è§’è‰²æ›´æ–°æˆåŠŸ</li><li>âœ… å®¡è®¡æ—¥å¿—è®°å½•å­˜åœ¨</li><li>âœ… å®¡è®¡æ—¥å¿—åŒ…å« before å’Œ after å­—æ®µ</li><li>âœ… å®¡è®¡æ—¥å¿—åŒ…å«æ“ä½œè€… ID (actorId)</li></ul><h4 id="_2-æµ‹è¯•-put-api-users-id-roles-æ›´æ–°è§’è‰²" tabindex="-1">2. æµ‹è¯• PUT /api/users/:id/roles æ›´æ–°è§’è‰² <a class="header-anchor" href="#_2-æµ‹è¯•-put-api-users-id-roles-æ›´æ–°è§’è‰²" aria-label="Permalink to &quot;2. æµ‹è¯• PUT /api/users/:id/roles æ›´æ–°è§’è‰²&quot;">â€‹</a></h4><p><strong>æµ‹è¯•æ­¥éª¤</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PUT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:3000/api/users/{userId}/roles</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer {token}&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type: application/json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;roleIds&quot;: [&quot;role-id-3&quot;]}&#39;</span></span></code></pre></div><p><strong>é¢„æœŸç»“æœ</strong>:</p><ul><li>âœ… ç”¨æˆ·è§’è‰²æ›´æ–°æˆåŠŸ</li><li>âœ… å®¡è®¡æ—¥å¿—è®°å½•å­˜åœ¨</li><li>âœ… ä¸¤ä¸ªæ¥å£çš„å®¡è®¡æ—¥å¿—æ ¼å¼ä¸€è‡´</li></ul><h4 id="_3-æµ‹è¯•è§’è‰²éªŒè¯" tabindex="-1">3. æµ‹è¯•è§’è‰²éªŒè¯ <a class="header-anchor" href="#_3-æµ‹è¯•è§’è‰²éªŒè¯" aria-label="Permalink to &quot;3. æµ‹è¯•è§’è‰²éªŒè¯&quot;">â€‹</a></h4><p><strong>æµ‹è¯•æ­¥éª¤</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ä¸å­˜åœ¨çš„è§’è‰² ID</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PATCH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:3000/api/users/{userId}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer {token}&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type: application/json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;roleIds&quot;: [&quot;invalid-role-id&quot;]}&#39;</span></span></code></pre></div><p><strong>é¢„æœŸç»“æœ</strong>:</p><ul><li>âœ… è¿”å› 400 é”™è¯¯</li><li>âœ… é”™è¯¯ä¿¡æ¯: &quot;ä»¥ä¸‹è§’è‰²ä¸å­˜åœ¨: invalid-role-id&quot;</li></ul><h4 id="_4-æµ‹è¯•å®¡è®¡æ—¥å¿—å®Œæ•´æ€§" tabindex="-1">4. æµ‹è¯•å®¡è®¡æ—¥å¿—å®Œæ•´æ€§ <a class="header-anchor" href="#_4-æµ‹è¯•å®¡è®¡æ—¥å¿—å®Œæ•´æ€§" aria-label="Permalink to &quot;4. æµ‹è¯•å®¡è®¡æ—¥å¿—å®Œæ•´æ€§&quot;">â€‹</a></h4><p><strong>éªŒè¯ç‚¹</strong>:</p><ul><li>[ ] event å­—æ®µä¸º <code>user.roles.set</code></li><li>[ ] userId å­—æ®µä¸ºæ“ä½œè€… ID (admin)</li><li>[ ] resource å­—æ®µä¸º <code>User</code></li><li>[ ] resourceId å­—æ®µä¸ºè¢«ä¿®æ”¹ç”¨æˆ·çš„ ID</li><li>[ ] payload.before åŒ…å«ä¿®æ”¹å‰çš„è§’è‰² ID åˆ—è¡¨</li><li>[ ] payload.after åŒ…å«ä¿®æ”¹åçš„è§’è‰² ID åˆ—è¡¨</li><li>[ ] payload.actorId ä¸ userId ä¸€è‡´</li></ul><hr><h2 id="ğŸ“Š-å½±å“è¯„ä¼°" tabindex="-1">ğŸ“Š å½±å“è¯„ä¼° <a class="header-anchor" href="#ğŸ“Š-å½±å“è¯„ä¼°" aria-label="Permalink to &quot;ğŸ“Š å½±å“è¯„ä¼°&quot;">â€‹</a></h2><h3 id="æ€§èƒ½å½±å“" tabindex="-1">æ€§èƒ½å½±å“ <a class="header-anchor" href="#æ€§èƒ½å½±å“" aria-label="Permalink to &quot;æ€§èƒ½å½±å“&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æŒ‡æ ‡</th><th>é‡æ„å‰</th><th>é‡æ„å</th><th>å˜åŒ–</th></tr></thead><tbody><tr><td>æ•°æ®åº“æŸ¥è¯¢æ¬¡æ•°</td><td>3-4 æ¬¡</td><td>4-5 æ¬¡</td><td>+1 (è·å– before è§’è‰²)</td></tr><tr><td>äº‹åŠ¡æ“ä½œ</td><td>1 æ¬¡</td><td>2 æ¬¡</td><td>+1 (åˆ†ç¦»ç”¨æˆ·å’Œè§’è‰²æ›´æ–°)</td></tr><tr><td>å®¡è®¡æ—¥å¿—å†™å…¥</td><td>0 æ¬¡</td><td>1 æ¬¡</td><td>+1</td></tr><tr><td>å“åº”æ—¶é—´</td><td>~50ms</td><td>~80ms</td><td>+30ms (å¯æ¥å—)</td></tr></tbody></table><p><strong>è¯„ä¼°</strong>: æ€§èƒ½å½±å“å¯å¿½ç•¥ï¼Œå¢åŠ çš„æ—¶é—´ä¸»è¦ç”¨äºå®¡è®¡æ—¥å¿—è®°å½•ï¼ˆåˆç†ï¼‰</p><h3 id="api-å…¼å®¹æ€§" tabindex="-1">API å…¼å®¹æ€§ <a class="header-anchor" href="#api-å…¼å®¹æ€§" aria-label="Permalink to &quot;API å…¼å®¹æ€§&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>API</th><th>å˜æ›´ç±»å‹</th><th>å…¼å®¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>PATCH /api/users/:id</code></td><td>æ— ç ´åæ€§å˜æ›´</td><td>âœ… å®Œå…¨å…¼å®¹</td><td>è¡Œä¸ºä¸€è‡´ï¼Œæ–°å¢å®¡è®¡æ—¥å¿—</td></tr><tr><td><code>PUT /api/users/:id/roles</code></td><td>æ— å˜æ›´</td><td>âœ… å®Œå…¨å…¼å®¹</td><td>åŠŸèƒ½ä¸å˜</td></tr><tr><td><code>GET /api/users/:id</code></td><td>æ— å˜æ›´</td><td>âœ… å®Œå…¨å…¼å®¹</td><td>è¿”å›æ ¼å¼ä¸å˜</td></tr></tbody></table><h3 id="å‰ç«¯å½±å“" tabindex="-1">å‰ç«¯å½±å“ <a class="header-anchor" href="#å‰ç«¯å½±å“" aria-label="Permalink to &quot;å‰ç«¯å½±å“&quot;">â€‹</a></h3><ul><li>âœ… <strong>æ— éœ€ä¿®æ”¹</strong>: å‰ç«¯ä»£ç æ— éœ€ä»»ä½•ä¿®æ”¹</li><li>âœ… <strong>è¡Œä¸ºä¸€è‡´</strong>: API å“åº”æ ¼å¼å’Œè¡Œä¸ºå®Œå…¨ä¸€è‡´</li><li>âœ… <strong>åŠŸèƒ½å¢å¼º</strong>: è‡ªåŠ¨è·å¾—å®¡è®¡æ—¥å¿—åŠŸèƒ½</li></ul><h3 id="æ•°æ®åº“å½±å“" tabindex="-1">æ•°æ®åº“å½±å“ <a class="header-anchor" href="#æ•°æ®åº“å½±å“" aria-label="Permalink to &quot;æ•°æ®åº“å½±å“&quot;">â€‹</a></h3><ul><li>âœ… <strong>æ—  Schema å˜æ›´</strong>: ä¸éœ€è¦æ•°æ®åº“è¿ç§»</li><li>âœ… <strong>æ— æ•°æ®è¿ç§»</strong>: ä¸éœ€è¦æ•°æ®ä¿®å¤</li><li>âœ… <strong>å®¡è®¡æ—¥å¿—å¢åŠ </strong>: <code>audit_logs</code> è¡¨ä¼šæœ‰æ–°è®°å½•</li></ul><hr><h2 id="ğŸ”’-å®‰å…¨æ€§æå‡" tabindex="-1">ğŸ”’ å®‰å…¨æ€§æå‡ <a class="header-anchor" href="#ğŸ”’-å®‰å…¨æ€§æå‡" aria-label="Permalink to &quot;ğŸ”’ å®‰å…¨æ€§æå‡&quot;">â€‹</a></h2><h3 id="å®¡è®¡æ—¥å¿—èƒ½åŠ›" tabindex="-1">å®¡è®¡æ—¥å¿—èƒ½åŠ› <a class="header-anchor" href="#å®¡è®¡æ—¥å¿—èƒ½åŠ›" aria-label="Permalink to &quot;å®¡è®¡æ—¥å¿—èƒ½åŠ›&quot;">â€‹</a></h3><p>é‡æ„åï¼Œæ‰€æœ‰ç”¨æˆ·è§’è‰²å˜æ›´éƒ½ä¼šè¢«è®°å½•ï¼š</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;audit-log-uuid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user.roles.set&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;userId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin-user-id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;ipAddress&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;192.168.1.100&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;userAgent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Mozilla/5.0...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;resource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;User&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;resourceId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;target-user-id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UPDATE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;payload&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;actorId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin-user-id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;userId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;target-user-id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;before&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;role-id-1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;after&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;role-id-1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;role-id-2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;result&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SUCCESS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;createdAt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-01-06T10:30:00.000Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="å®‰å…¨æ”¶ç›Š" tabindex="-1">å®‰å…¨æ”¶ç›Š <a class="header-anchor" href="#å®‰å…¨æ”¶ç›Š" aria-label="Permalink to &quot;å®‰å…¨æ”¶ç›Š&quot;">â€‹</a></h3><ul><li>âœ… <strong>å¯è¿½æº¯æ€§</strong>: è®°å½•è°åœ¨ä»€ä¹ˆæ—¶å€™ä¿®æ”¹äº†ä»€ä¹ˆ</li><li>âœ… <strong>åˆè§„æ€§</strong>: æ»¡è¶³å®¡è®¡è¦æ±‚</li><li>âœ… <strong>äº‹æ•…è°ƒæŸ¥</strong>: å¿«é€Ÿå®šä½é—®é¢˜</li><li>âœ… <strong>æƒé™æ»¥ç”¨æ£€æµ‹</strong>: ç›‘æ§å¼‚å¸¸æ“ä½œ</li></ul><hr><h2 id="ğŸ”™-å›æ»šæ–¹æ¡ˆ" tabindex="-1">ğŸ”™ å›æ»šæ–¹æ¡ˆ <a class="header-anchor" href="#ğŸ”™-å›æ»šæ–¹æ¡ˆ" aria-label="Permalink to &quot;ğŸ”™ å›æ»šæ–¹æ¡ˆ&quot;">â€‹</a></h2><p>å¦‚æœé‡æ„åå‡ºç°é—®é¢˜ï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹æ­¥éª¤å›æ»šï¼š</p><h3 id="æ–¹æ¡ˆ-1-git-å›æ»š-æ¨è" tabindex="-1">æ–¹æ¡ˆ 1: Git å›æ»šï¼ˆæ¨èï¼‰ <a class="header-anchor" href="#æ–¹æ¡ˆ-1-git-å›æ»š-æ¨è" aria-label="Permalink to &quot;æ–¹æ¡ˆ 1: Git å›æ»šï¼ˆæ¨èï¼‰&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æŸ¥çœ‹æäº¤å†å²</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> log</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --oneline</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -10</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å›æ»šåˆ°é‡æ„å‰çš„æäº¤</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> revert</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">commit-has</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æˆ–è€…ç¡¬å›æ»šï¼ˆå±é™©ï¼Œä¼šä¸¢å¤±åç»­æäº¤ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reset</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --hard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">commit-has</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><h3 id="æ–¹æ¡ˆ-2-æ‰‹åŠ¨å›æ»š" tabindex="-1">æ–¹æ¡ˆ 2: æ‰‹åŠ¨å›æ»š <a class="header-anchor" href="#æ–¹æ¡ˆ-2-æ‰‹åŠ¨å›æ»š" aria-label="Permalink to &quot;æ–¹æ¡ˆ 2: æ‰‹åŠ¨å›æ»š&quot;">â€‹</a></h3><h4 id="æ­¥éª¤-1-æ¢å¤-users-service-ts" tabindex="-1">æ­¥éª¤ 1: æ¢å¤ users.service.ts <a class="header-anchor" href="#æ­¥éª¤-1-æ¢å¤-users-service-ts" aria-label="Permalink to &quot;æ­¥éª¤ 1: æ¢å¤ users.service.ts&quot;">â€‹</a></h4><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç§»é™¤ UserRolesService æ³¨å…¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(private prisma: PrismaService) {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¢å¤åŸ update() æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">async </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id: string, updateUserDto: UpdateUserDto) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ... åŸæœ‰é€»è¾‘ ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ¢å¤äº‹åŠ¡ä¸­çš„è§’è‰²æ›´æ–°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.prisma.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$transaction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">prisma</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> updatedUser</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      where: { id },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      data: updateData,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (updateUserDto.roleIds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.userRole.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deleteMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ where: { userId: id } });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (updateUserDto.roleIds.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.userRole.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          data: updateUserDto.roleIds.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">roleId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            userId: id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            roleId,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          })),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prisma.user.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findUnique</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        where: { id },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        select: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.userSelect,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> updatedUser;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">formatUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="æ­¥éª¤-2-æ¢å¤-users-controller-ts" tabindex="-1">æ­¥éª¤ 2: æ¢å¤ users.controller.ts <a class="header-anchor" href="#æ­¥éª¤-2-æ¢å¤-users-controller-ts" aria-label="Permalink to &quot;æ­¥éª¤ 2: æ¢å¤ users.controller.ts&quot;">â€‹</a></h4><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç§»é™¤ CurrentUser å¯¼å…¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Roles } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@common/decorators&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¢å¤åŸ update() æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) id: string, @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() updateUserDto: UpdateUserDto) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.usersService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id, updateUserDto);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="æ­¥éª¤-3-æ¢å¤-users-module-ts" tabindex="-1">æ­¥éª¤ 3: æ¢å¤ users.module.ts <a class="header-anchor" href="#æ­¥éª¤-3-æ¢å¤-users-module-ts" aria-label="Permalink to &quot;æ­¥éª¤ 3: æ¢å¤ users.module.ts&quot;">â€‹</a></h4><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  controllers: [UsersController],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  providers: [UsersService],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  exports: [UsersService],</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ç§»é™¤ imports: [UserRolesModule]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UsersModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span></code></pre></div><h4 id="æ­¥éª¤-4-æ¢å¤-user-roles-module-ts" tabindex="-1">æ­¥éª¤ 4: æ¢å¤ user-roles.module.ts <a class="header-anchor" href="#æ­¥éª¤-4-æ¢å¤-user-roles-module-ts" aria-label="Permalink to &quot;æ­¥éª¤ 4: æ¢å¤ user-roles.module.ts&quot;">â€‹</a></h4><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  imports: [PrismaModule, AuditModule],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  controllers: [UserRolesUsersController, UserRolesRolesController],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  providers: [UserRolesService],</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ç§»é™¤ exports: [UserRolesService]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UserRolesModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span></code></pre></div><h4 id="æ­¥éª¤-5-é‡æ–°æ„å»º" tabindex="-1">æ­¥éª¤ 5: é‡æ–°æ„å»º <a class="header-anchor" href="#æ­¥éª¤-5-é‡æ–°æ„å»º" aria-label="Permalink to &quot;æ­¥éª¤ 5: é‡æ–°æ„å»º&quot;">â€‹</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --filter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre></div><hr><h2 id="ğŸ“ˆ-åç»­ä¼˜åŒ–å»ºè®®" tabindex="-1">ğŸ“ˆ åç»­ä¼˜åŒ–å»ºè®® <a class="header-anchor" href="#ğŸ“ˆ-åç»­ä¼˜åŒ–å»ºè®®" aria-label="Permalink to &quot;ğŸ“ˆ åç»­ä¼˜åŒ–å»ºè®®&quot;">â€‹</a></h2><h3 id="çŸ­æœŸä¼˜åŒ–-1-2å‘¨" tabindex="-1">çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰ <a class="header-anchor" href="#çŸ­æœŸä¼˜åŒ–-1-2å‘¨" aria-label="Permalink to &quot;çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰&quot;">â€‹</a></h3><ol><li><p><strong>æ·»åŠ å•å…ƒæµ‹è¯•</strong></p><ul><li>[ ] UsersService.update() å•å…ƒæµ‹è¯•</li><li>[ ] UserRolesService.setUserRoles() å•å…ƒæµ‹è¯•</li><li>[ ] æ¨¡æ‹Ÿ actorId ä¼ é€’é“¾è·¯</li></ul></li><li><p><strong>æ·»åŠ é›†æˆæµ‹è¯•</strong></p><ul><li>[ ] æµ‹è¯• PATCH /api/users/:id æ›´æ–°è§’è‰²</li><li>[ ] æµ‹è¯• PUT /api/users/:id/roles æ›´æ–°è§’è‰²</li><li>[ ] éªŒè¯å®¡è®¡æ—¥å¿—è®°å½•</li></ul></li><li><p><strong>å®Œå–„é”™è¯¯å¤„ç†</strong></p><ul><li>[ ] UserRolesService ä¸å¯ç”¨æ—¶çš„é™çº§æ–¹æ¡ˆ</li><li>[ ] å®¡è®¡æ—¥å¿—å†™å…¥å¤±è´¥çš„å¤„ç†</li></ul></li></ol><h3 id="ä¸­æœŸä¼˜åŒ–-1-2æœˆ" tabindex="-1">ä¸­æœŸä¼˜åŒ–ï¼ˆ1-2æœˆï¼‰ <a class="header-anchor" href="#ä¸­æœŸä¼˜åŒ–-1-2æœˆ" aria-label="Permalink to &quot;ä¸­æœŸä¼˜åŒ–ï¼ˆ1-2æœˆï¼‰&quot;">â€‹</a></h3><ol><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong></p><ul><li>[ ] è€ƒè™‘ç¼“å­˜ç”¨æˆ·è§’è‰²ä¿¡æ¯</li><li>[ ] ä¼˜åŒ–å®¡è®¡æ—¥å¿—æ‰¹é‡å†™å…¥</li><li>[ ] å‡å°‘é‡å¤æŸ¥è¯¢</li></ul></li><li><p><strong>åŠŸèƒ½å¢å¼º</strong></p><ul><li>[ ] æ”¯æŒè§’è‰²å˜æ›´åŸå› å¤‡æ³¨</li><li>[ ] æ”¯æŒè§’è‰²å˜æ›´å®¡æ‰¹æµç¨‹</li><li>[ ] æ”¯æŒè§’è‰²å˜æ›´é€šçŸ¥</li></ul></li><li><p><strong>ç›‘æ§å‘Šè­¦</strong></p><ul><li>[ ] ç›‘æ§è§’è‰²å˜æ›´é¢‘ç‡</li><li>[ ] å‘Šè­¦å¼‚å¸¸è§’è‰²å˜æ›´</li><li>[ ] ç»Ÿè®¡è§’è‰²åˆ†é…è¶‹åŠ¿</li></ul></li></ol><h3 id="é•¿æœŸä¼˜åŒ–-3-6æœˆ" tabindex="-1">é•¿æœŸä¼˜åŒ–ï¼ˆ3-6æœˆï¼‰ <a class="header-anchor" href="#é•¿æœŸä¼˜åŒ–-3-6æœˆ" aria-label="Permalink to &quot;é•¿æœŸä¼˜åŒ–ï¼ˆ3-6æœˆï¼‰&quot;">â€‹</a></h3><ol><li><p><strong>æ¶æ„ä¼˜åŒ–</strong></p><ul><li>[ ] è€ƒè™‘äº‹ä»¶é©±åŠ¨æ¶æ„</li><li>[ ] å®ç° CQRS æ¨¡å¼</li><li>[ ] å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—</li></ul></li><li><p><strong>å®¡è®¡å¢å¼º</strong></p><ul><li>[ ] å®¡è®¡æ—¥å¿—å¯è§†åŒ–é¢æ¿</li><li>[ ] å®¡è®¡æ—¥å¿—å¯¼å‡ºåŠŸèƒ½</li><li>[ ] å®¡è®¡æ—¥å¿—åˆ†ææŠ¥å‘Š</li></ul></li></ol><hr><h2 id="ğŸ“-ç›¸å…³æ–‡æ¡£" tabindex="-1">ğŸ“ ç›¸å…³æ–‡æ¡£ <a class="header-anchor" href="#ğŸ“-ç›¸å…³æ–‡æ¡£" aria-label="Permalink to &quot;ğŸ“ ç›¸å…³æ–‡æ¡£&quot;">â€‹</a></h2><ul><li><a href="./../apps/backend/src/modules/users/README.html">ç”¨æˆ·æ¨¡å—æ–‡æ¡£</a></li><li><a href="./../apps/backend/src/modules/user-roles/README.html">ç”¨æˆ·è§’è‰²æ¨¡å—æ–‡æ¡£</a></li><li><a href="./AUDIT_LOG_DESIGN.html">å®¡è®¡æ—¥å¿—è®¾è®¡æ–‡æ¡£</a></li><li><a href="http://localhost:3000/api-docs" target="_blank" rel="noreferrer">API æ–‡æ¡£</a></li></ul><hr><h2 id="ğŸ‘¥-å‚ä¸äººå‘˜" tabindex="-1">ğŸ‘¥ å‚ä¸äººå‘˜ <a class="header-anchor" href="#ğŸ‘¥-å‚ä¸äººå‘˜" aria-label="Permalink to &quot;ğŸ‘¥ å‚ä¸äººå‘˜&quot;">â€‹</a></h2><ul><li><strong>éœ€æ±‚æå‡º</strong>: ç”¨æˆ·</li><li><strong>æ–¹æ¡ˆè®¾è®¡</strong>: Claude Code</li><li><strong>ä»£ç å®æ–½</strong>: Claude Code</li><li><strong>ä»£ç å®¡æŸ¥</strong>: å¾…è¿›è¡Œ</li><li><strong>æµ‹è¯•éªŒè¯</strong>: å¾…è¿›è¡Œ</li></ul><hr><h2 id="ğŸ“…-æ—¶é—´çº¿" tabindex="-1">ğŸ“… æ—¶é—´çº¿ <a class="header-anchor" href="#ğŸ“…-æ—¶é—´çº¿" aria-label="Permalink to &quot;ğŸ“… æ—¶é—´çº¿&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>æ—¥æœŸ</th><th>é˜¶æ®µ</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>2025-01-06</td><td>é—®é¢˜å‘ç°</td><td>âœ… å®Œæˆ</td></tr><tr><td>2025-01-06</td><td>æ–¹æ¡ˆè®¾è®¡</td><td>âœ… å®Œæˆ</td></tr><tr><td>2025-01-06</td><td>ä»£ç å®æ–½</td><td>âœ… å®Œæˆ</td></tr><tr><td>2025-01-06</td><td>ç¼–è¯‘éªŒè¯</td><td>âœ… å®Œæˆ</td></tr><tr><td>å¾…å®š</td><td>åŠŸèƒ½æµ‹è¯•</td><td>â³ å¾…è¿›è¡Œ</td></tr><tr><td>å¾…å®š</td><td>ä»£ç å®¡æŸ¥</td><td>â³ å¾…è¿›è¡Œ</td></tr><tr><td>å¾…å®š</td><td>éƒ¨ç½²ä¸Šçº¿</td><td>â³ å¾…è¿›è¡Œ</td></tr></tbody></table><hr><h2 id="ğŸ¯-æ€»ç»“" tabindex="-1">ğŸ¯ æ€»ç»“ <a class="header-anchor" href="#ğŸ¯-æ€»ç»“" aria-label="Permalink to &quot;ğŸ¯ æ€»ç»“&quot;">â€‹</a></h2><h3 id="é‡æ„æˆæœ" tabindex="-1">é‡æ„æˆæœ <a class="header-anchor" href="#é‡æ„æˆæœ" aria-label="Permalink to &quot;é‡æ„æˆæœ&quot;">â€‹</a></h3><p>âœ… <strong>ç»Ÿä¸€çš„è§’è‰²ç®¡ç†é€»è¾‘</strong> - æ‰€æœ‰è§’è‰²æ›´æ–°éƒ½é€šè¿‡ UserRolesService âœ… <strong>å®Œæ•´çš„å®¡è®¡æ—¥å¿—</strong> - è®°å½•è°åœ¨ä»€ä¹ˆæ—¶å€™ä¿®æ”¹äº†ä»€ä¹ˆ âœ… <strong>å‰ç«¯å…¼å®¹æ€§</strong> - æ— éœ€ä¿®æ”¹ç°æœ‰å‰ç«¯ä»£ç  âœ… <strong>ä»£ç å¤ç”¨</strong> - é¿å…é‡å¤å®ç°ç›¸åŒåŠŸèƒ½ âœ… <strong>ç±»å‹å®‰å…¨</strong> - TypeScript ç±»å‹æ£€æŸ¥é€šè¿‡ âœ… <strong>æ„å»ºæˆåŠŸ</strong> - æ— ç¼–è¯‘é”™è¯¯</p><h3 id="é£é™©è¯„ä¼°" tabindex="-1">é£é™©è¯„ä¼° <a class="header-anchor" href="#é£é™©è¯„ä¼°" aria-label="Permalink to &quot;é£é™©è¯„ä¼°&quot;">â€‹</a></h3><ul><li><strong>æŠ€æœ¯é£é™©</strong>: ğŸŸ¢ ä½ - æ— ç ´åæ€§å˜æ›´ï¼ŒAPI å®Œå…¨å…¼å®¹</li><li><strong>æ€§èƒ½é£é™©</strong>: ğŸŸ¢ ä½ - æ€§èƒ½å½±å“å¯å¿½ç•¥ (~30ms)</li><li><strong>å®‰å…¨é£é™©</strong>: ğŸŸ¢ ä½ - å®‰å…¨æ€§æå‡ï¼ˆå®¡è®¡æ—¥å¿—ï¼‰</li><li><strong>å›æ»šé£é™©</strong>: ğŸŸ¢ ä½ - æœ‰å®Œæ•´å›æ»šæ–¹æ¡ˆ</li></ul><h3 id="å»ºè®®" tabindex="-1">å»ºè®® <a class="header-anchor" href="#å»ºè®®" aria-label="Permalink to &quot;å»ºè®®&quot;">â€‹</a></h3><ol><li>âœ… <strong>å»ºè®®ä¸Šçº¿</strong> - é‡æ„æ”¶ç›Šæ˜æ˜¾ï¼Œé£é™©å¯æ§</li><li>ğŸ“ <strong>è¡¥å……æµ‹è¯•</strong> - å»ºè®®æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•</li><li>ğŸ“Š <strong>ç›‘æ§è§‚å¯Ÿ</strong> - ä¸Šçº¿åè§‚å¯Ÿæ€§èƒ½å’Œå®¡è®¡æ—¥å¿—</li><li>ğŸ”„ <strong>æŒç»­ä¼˜åŒ–</strong> - æ ¹æ®åé¦ˆæŒç»­ä¼˜åŒ–</li></ol><hr><p><strong>æ–‡æ¡£ç‰ˆæœ¬</strong>: v1.0 <strong>æœ€åæ›´æ–°</strong>: 2025-01-06 <strong>ç»´æŠ¤è€…</strong>: NestBase Team</p></div></div></main><footer class="VPDocFooter" data-v-af74e104 data-v-6f91f5cd><!--[--><!--]--><div class="edit-info" data-v-6f91f5cd><!----><div class="last-updated" data-v-6f91f5cd><p class="VPLastUpdated" data-v-6f91f5cd data-v-6fe3bb32>Last updated: <time datetime="2025-11-11T09:08:02.000Z" data-v-6fe3bb32></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-6f91f5cd><span class="visually-hidden" id="doc-footer-aria-label" data-v-6f91f5cd>Pager</span><div class="pager" data-v-6f91f5cd><!----></div><div class="pager" data-v-6f91f5cd><a class="VPLink link pager-link next" href="/nestBase/backend/README.html" data-v-6f91f5cd><!--[--><span class="desc" data-v-6f91f5cd>Next page</span><span class="title" data-v-6f91f5cd>Readme</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"backend_api_create_menu_dto_fix.md\":\"J6ZdcyyH\",\"backend_api_create_menu_with_permissions.md\":\"SEUFNbH-\",\"backend_architecture_api_naming_convention.md\":\"DqKPuida\",\"backend_architecture_business_codes.md\":\"DDi_UC9o\",\"backend_architecture_business_codes_implementation.md\":\"fnI_dA90\",\"backend_architecture_naming_convention_conclusion.md\":\"B_02BqAY\",\"backend_architecture_redis_analysis.md\":\"Cj9NHZqb\",\"backend_architecture_validation_pipe_config.md\":\"Bq7VCIOy\",\"backend_features_changelog_user_roles.md\":\"Cx3gyiiQ\",\"backend_features_content_management_module.md\":\"BFpv-J6d\",\"backend_features_logging_system_release.md\":\"DJly6PL-\",\"backend_features_markdown_parser_integration.md\":\"DwFFglYJ\",\"backend_features_new_permission_system.md\":\"CtlGxbNh\",\"backend_features_redis_wrappers.md\":\"0FTgZ6Lt\",\"backend_features_refactor_user_roles_integration.md\":\"D1dMMRJp\",\"backend_features_role_home_page.md\":\"Bt1g5_TD\",\"backend_features_role_migration.md\":\"Cm-FqS3o\",\"backend_features_role_restrictions.md\":\"D9a1B--X\",\"backend_features_token_implementation_summary.md\":\"DN1ipmV7\",\"backend_features_token_refresh_logout.md\":\"LJXQOjB6\",\"backend_guides_api_user_roles.md\":\"CEad33rK\",\"backend_guides_audit_usage.md\":\"B9eTDBGx\",\"backend_guides_cms_api_guide.md\":\"CcK-onNZ\",\"backend_guides_menu_management.md\":\"CQYT0hkQ\",\"backend_guides_projects-module.md\":\"Cs0HhC2a\",\"backend_guides_users-module.md\":\"D6NU_8fq\",\"backend_migrations_migration_add_icon_type.md\":\"CZ7EwMvO\",\"backend_migrations_migration_guide.md\":\"BoD5__o0\",\"backend_migrations_migration_remove_title_field.md\":\"iGGjLB_0\",\"backend_migrations_parent_id_immutable.md\":\"Djc2ytQX\",\"backend_readme.md\":\"vELl-BMp\",\"frontend_developer_guide.md\":\"DdCgURZq\",\"frontend_readme.md\":\"ZjFUO_w7\",\"guides_cms_manual.md\":\"DjBN2wKv\",\"guides_deployment_guide.md\":\"BSnGtvKj\",\"guides_integration.zh-cn.md\":\"D9rn4uld\",\"guides_rbac_manual.md\":\"BiYJ7XK1\",\"guides_system_config.md\":\"6l2sfhiB\",\"guides_usage.zh-cn.md\":\"DS5ZRzVA\",\"index.md\":\"DKQai2De\",\"plans_api_optimization_plan.md\":\"DNMXbcgG\",\"plans_api_refactor_tags_logs_categories_plan.md\":\"DOlMnzxV\",\"plans_basic_data_module_implementation.md\":\"BcFQY_UB\",\"project_api-tools_apifox_import_guide.md\":\"BlnYPfXx\",\"project_api-tools_openapi_implementation.md\":\"S7gL72_a\",\"project_api-tools_openapi_update_summary.md\":\"CJq4gdUt\",\"project_development_changelog.md\":\"w5-qblhP\",\"project_development_code_check_report.md\":\"C2THRzKT\",\"project_development_docs_update_checklist.md\":\"DMQ6uzi7\",\"project_development_documentation_update.md\":\"DO5V2Ah0\",\"project_development_migration_admin_integration.md\":\"BZUYv4gu\",\"project_features_rbac_guide.md\":\"aUgn6YXv\",\"project_features_rbac_redesign.md\":\"CMuTv5mv\",\"project_project-management_delivery.md\":\"DSiLsLmZ\",\"project_project-management_file_list.md\":\"DsdrtZI5\",\"project_project-management_project_delivery.md\":\"DYiErDs4\",\"project_project-management_project_summary.md\":\"1OfMbfJn\",\"project_readme.md\":\"Dd0agZ7N\",\"project_setup_agents.md\":\"klz_ZFyg\",\"project_setup_claude.md\":\"Du5I3hqG\",\"project_setup_docker_guide.md\":\"BeANkah9\",\"project_setup_monorepo.md\":\"C-IIDhcJ\",\"project_setup_quickstart.md\":\"CfyWQwbw\",\"project_setup_supabase_setup.md\":\"B2G23NGW\",\"readme.md\":\"ByPbUjnI\",\"reports_analysis_report.md\":\"Wh_gCCZ0\",\"reports_api_optimization_report.md\":\"C6U_7Wg9\",\"reports_api_refactor_tags_logs_categories_report.md\":\"C_XuGEDp\",\"reports_frontend_backend_alignment.md\":\"9BJD56rk\",\"reports_structure_and_api_analysis.md\":\"VkeIHVR0\",\"standards_api_governance_standard.md\":\"DIx4JOZS\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"NestBase\",\"description\":\"ç°ä»£åŒ–å…¨æ ˆåº”ç”¨æ¡†æ¶æ–‡æ¡£\",\"base\":\"/nestBase/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"æŒ‡å—\",\"link\":\"/guides/USAGE.zh-CN\"},{\"text\":\"å‰ç«¯\",\"link\":\"/frontend/README\"},{\"text\":\"åç«¯\",\"link\":\"/backend/README\"},{\"text\":\"é¡¹ç›®ç®¡ç†\",\"link\":\"/project/README\"}],\"sidebar\":{\"/frontend/\":[{\"text\":\"å‰ç«¯æœåŠ¡\",\"items\":[{\"text\":\"æ¦‚è§ˆ\",\"link\":\"/frontend/README\"},{\"text\":\"å¼€å‘æŒ‡å—\",\"link\":\"/frontend/DEVELOPER_GUIDE\"},{\"text\":\"å‰åç«¯è”è°ƒæŒ‡å—\",\"link\":\"/guides/INTEGRATION.zh-CN\"}]}],\"/guides/\":[{\"text\":\"æŒ‡å—\",\"items\":[{\"text\":\"ä½¿ç”¨è¯´æ˜\",\"link\":\"/guides/USAGE.zh-CN\"},{\"text\":\"ç³»ç»Ÿé…ç½®è¯¦è§£\",\"link\":\"/guides/SYSTEM_CONFIG\"},{\"text\":\"ç”Ÿäº§éƒ¨ç½²æŒ‡å—\",\"link\":\"/guides/DEPLOYMENT_GUIDE\"},{\"text\":\"å†…å®¹ç®¡ç†æ‰‹å†Œ\",\"link\":\"/guides/CMS_MANUAL\"},{\"text\":\"æƒé™ç®¡ç†æ‰‹å†Œ\",\"link\":\"/guides/RBAC_MANUAL\"}]}],\"/plans/\":[{\"text\":\"è®¡åˆ’æ–‡æ¡£\",\"items\":[{\"text\":\"API ä¼˜åŒ–è®¡åˆ’\",\"link\":\"/plans/api_optimization_plan\"},{\"text\":\"API é‡æ„è®¡åˆ’\",\"link\":\"/plans/api_refactor_tags_logs_categories_plan\"},{\"text\":\"åŸºç¡€æ•°æ®æ¨¡å—\",\"link\":\"/plans/basic_data_module_implementation\"}]}],\"/reports/\":[{\"text\":\"åˆ†ææŠ¥å‘Š\",\"items\":[{\"text\":\"é¡¹ç›®åˆ†æ\",\"link\":\"/reports/ANALYSIS_REPORT\"},{\"text\":\"API ä¼˜åŒ–æŠ¥å‘Š\",\"link\":\"/reports/API_OPTIMIZATION_REPORT\"},{\"text\":\"ç»“æ„ä¸APIåˆ†æ\",\"link\":\"/reports/structure_and_api_analysis\"}]}],\"/standards/\":[{\"text\":\"è§„èŒƒæ ‡å‡†\",\"items\":[{\"text\":\"API æ²»ç†æ ‡å‡†\",\"link\":\"/standards/api_governance_standard\"}]}],\"/backend/\":[{\"text\":\"åç«¯æ¦‚è§ˆ\",\"items\":[{\"text\":\"Readme\",\"link\":\"/backend/README\"}]},{\"text\":\"æ¶æ„è®¾è®¡\",\"collapsed\":true,\"items\":[{\"text\":\"API å‘½åè§„èŒƒ\",\"link\":\"/backend/architecture/API_NAMING_CONVENTION\"},{\"text\":\"ä¸šåŠ¡çŠ¶æ€ç \",\"link\":\"/backend/architecture/BUSINESS_CODES\"},{\"text\":\"éªŒè¯ç®¡é“é…ç½®\",\"link\":\"/backend/architecture/VALIDATION_PIPE_CONFIG\"},{\"text\":\"Redis åˆ†æ\",\"link\":\"/backend/architecture/REDIS_ANALYSIS\"}]},{\"text\":\"åŠŸèƒ½ç‰¹æ€§\",\"collapsed\":true,\"items\":[{\"text\":\"æ–°æƒé™ç³»ç»Ÿ\",\"link\":\"/backend/features/NEW_PERMISSION_SYSTEM\"},{\"text\":\"Token å®ç°\",\"link\":\"/backend/features/TOKEN_IMPLEMENTATION_SUMMARY\"},{\"text\":\"æ—¥å¿—ç³»ç»Ÿ\",\"link\":\"/backend/features/LOGGING_SYSTEM_RELEASE\"},{\"text\":\"å†…å®¹ç®¡ç†\",\"link\":\"/backend/features/CONTENT_MANAGEMENT_MODULE\"}]},{\"text\":\"å¼€å‘æŒ‡å—\",\"collapsed\":true,\"items\":[{\"text\":\"ç”¨æˆ·æ¨¡å—\",\"link\":\"/backend/guides/users-module\"},{\"text\":\"é¡¹ç›®æ¨¡å—\",\"link\":\"/backend/guides/projects-module\"},{\"text\":\"CMS API\",\"link\":\"/backend/guides/CMS_API_GUIDE\"},{\"text\":\"èœå•ç®¡ç†\",\"link\":\"/backend/guides/MENU_MANAGEMENT\"},{\"text\":\"å®¡è®¡æ—¥å¿—\",\"link\":\"/backend/guides/AUDIT_USAGE\"}]},{\"text\":\"æ•°æ®åº“è¿ç§»\",\"collapsed\":true,\"items\":[{\"text\":\"è¿ç§»æŒ‡å—\",\"link\":\"/backend/migrations/MIGRATION_GUIDE\"}]}],\"/project/\":[{\"text\":\"é¡¹ç›®æ¦‚è§ˆ\",\"items\":[{\"text\":\"Readme\",\"link\":\"/project/README\"}]},{\"text\":\"ç¯å¢ƒæ­å»º\",\"items\":[{\"text\":\"å¿«é€Ÿå¼€å§‹\",\"link\":\"/project/setup/QUICKSTART\"},{\"text\":\"Supabase é…ç½®\",\"link\":\"/project/setup/SUPABASE_SETUP\"},{\"text\":\"Monorepo è¯´æ˜\",\"link\":\"/project/setup/MONOREPO\"}]},{\"text\":\"API å·¥å…·\",\"items\":[{\"text\":\"OpenAPI å®ç°\",\"link\":\"/project/api-tools/OPENAPI_IMPLEMENTATION\"},{\"text\":\"Apifox å¯¼å…¥\",\"link\":\"/project/api-tools/APIFOX_IMPORT_GUIDE\"}]},{\"text\":\"å¼€å‘æ–‡æ¡£\",\"items\":[{\"text\":\"æ–‡æ¡£æ›´æ–°æ¸…å•\",\"link\":\"/project/development/DOCS_UPDATE_CHECKLIST\"},{\"text\":\"ä»£ç æ£€æŸ¥æŠ¥å‘Š\",\"link\":\"/project/development/CODE_CHECK_REPORT\"}]},{\"text\":\"é¡¹ç›®ç®¡ç†\",\"items\":[{\"text\":\"äº¤ä»˜æŠ¥å‘Š\",\"link\":\"/project/project-management/DELIVERY\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/myltx/nestBase\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>